theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
ModMem_0.05
ModMem_D1
loopModCol     <- x[i,]
loopModCol_cor <- paste("MM.", loopModCol, sep = '')
loopModCol_p   <- paste("p.MM.", loopModCol, sep = '')
# all modules per mod color (with significant eigengene-treatment interaction) - no Module Membership threshold
ModMem         <- ModMem_D1 %>%
dplyr::select(c('TranscriptID',moduleColor, loopModCol_p, loopModCol_cor)) %>%
dplyr::filter(moduleColor %in% loopModCol)
loopModCol     <- x[i,]
loopModCol_cor <- paste("MM.", loopModCol, sep = '')
loopModCol_p   <- paste("p.MM.", loopModCol, sep = '')
# all modules per mod color (with significant eigengene-treatment interaction) - no Module Membership threshold
ModMem         <- ModMem_D1 %>%
dplyr::select(c('TranscriptID',moduleColor, loopModCol_p, loopModCol_cor)) %>%
dplyr::filter(moduleColor %in% loopModCol)
ModMem
ModMem %>%
dplyr::filter(.[[3]] < 0.05)
ModMem %>%
dplyr::filter(.[[3]] < 0.05 & .[[4]] > 0.7)
# data frames and loop sets for the for statement below;
D1_modCols        <- as.data.frame(unique(ModMem_D1$moduleColor))
meanExp_total     <- data.frame()
meanExp_statsloop <- data.frame(matrix(nrow = 1, ncol = 5)) # create dataframe to save cumunalitively during for loop
colnames(meanExp_statsloop) <- c('Day', 'modColor', 'Gene.count', 'Gene.count.MM<0.5', 'Percent_MM<0.05') # names for comuns in the for loop
meanExp_stats     <- data.frame()
for (i in 1:nrow(D1_modCols)) {
loopModCol     <- x[i,]
loopModCol_cor <- paste("MM.", loopModCol, sep = '')
loopModCol_p   <- paste("p.MM.", loopModCol, sep = '')
# all modules per mod color (with significant eigengene-treatment interaction) - no Module Membership threshold
ModMem         <- ModMem_D1 %>%
dplyr::select(c('TranscriptID',moduleColor, loopModCol_p, loopModCol_cor)) %>%
dplyr::filter(moduleColor %in% loopModCol)
# all modules per mod color (with significant eigengene-treatment interaction) - Module Membership p < 0.05 based on DEG overalap (view R script)
ModMem_0.05    <- ModMem %>%
dplyr::filter(.[[3]] < 0.05 & .[[4]] > 0.7)
MM_0.5_meanExp <- as.data.frame(colMeans(merge(ModMem_0.05, rlog_WGCNA_D1, by = 'TranscriptID')[,-c(1:3)])) %>%  # mean expression by sampleID for this reduced gene pool (Module membership p < 0.05)
dplyr::mutate(modcolor = loopModCol) %>%
tibble::rownames_to_column("SampleID") %>%
dplyr::rename(meanExp = 2)
# print this loop Rbdin for each module
meanExp_total <- rbind(meanExp_total,MM_0.5_meanExp) #bind to a cumulative list dataframe
print(meanExp_total) # print to monitor progress
# print stats for each module - these will assist stats for the 0.05 threshold
meanExp_statsloop$Day                 <- 1
meanExp_statsloop$modColor            <- loopModCol
meanExp_statsloop$Gene.count          <- nrow(ModMem)
meanExp_statsloop$`Gene.count.MM<0.5` <- nrow(ModMem_0.05)
meanExp_statsloop$`Percent_MM<0.05`   <- (nrow(ModMem_0.05) / nrow(ModMem)) * 100
df            <- data.frame(meanExp_statsloop) # name dataframe for this single row
meanExp_stats <- rbind(meanExp_stats,df) #bind to a cumulative list dataframe
print(meanExp_stats) # print to monitor progress
}
meanExp_total_wide <- reshape2::dcast(meanExp_total, SampleID ~ modcolor, value.var="meanExp") # convert to wide format to merge for OCA analysis with physiological variables
meanExp_Master     <- merge(d2.Seq_SampleKey, meanExp_total_wide) %>% select(-c(Temperature, OA, Salinity, Age.days))
meanExp_stats # percent contribution of Module member threhsold cutoff to the total modul emembersip
# Run a PCA for Day 1
Master_Day1$Day <- as.factor(Master_Day1$Day) # convert Day into a factor
Day1PCA         <- (merge(Master_Day1, meanExp_Master) %>% dplyr::select(-c(green,yellow)))
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
phys_pca1   <- prcomp(Day1PCA[,c(11:16)],   # modules only   (cumulative 0.6990 )
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8)],   # phys only  - PCA 1 = 0.5805  PCA 2 0.2946   (cumulative 0.8751 )
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
Day1PCA         <- (merge(Master_Day1, meanExp_Master) %>% dplyr::select(-c(green,yellow)))[-9,]
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
phys_pca1   <- prcomp(Day1PCA[,c(11:16)],   # modules only   (cumulative 0.6990 )
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8,12)],   # main effect modules only (brown blur, turquoise)   (cumulative 96.28)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
Day1PCA
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
meanExp_stats # percent contribution of Module member threhsold cutoff to the total modul emembersip
# data frames and loop sets for the for statement below;
D1_modCols        <- as.data.frame(unique(ModMem_D1$moduleColor))
meanExp_total     <- data.frame()
meanExp_statsloop <- data.frame(matrix(nrow = 1, ncol = 5)) # create dataframe to save cumunalitively during for loop
colnames(meanExp_statsloop) <- c('Day', 'modColor', 'Gene.count', 'Gene.count.MM<0.5', 'Percent_MM<0.05') # names for comuns in the for loop
meanExp_stats     <- data.frame()
for (i in 1:nrow(D1_modCols)) {
loopModCol     <- x[i,]
loopModCol_cor <- paste("MM.", loopModCol, sep = '')
loopModCol_p   <- paste("p.MM.", loopModCol, sep = '')
# all modules per mod color (with significant eigengene-treatment interaction) - no Module Membership threshold
ModMem         <- ModMem_D1 %>%
dplyr::select(c('TranscriptID',moduleColor, loopModCol_p, loopModCol_cor)) %>%
dplyr::filter(moduleColor %in% loopModCol)
# all modules per mod color (with significant eigengene-treatment interaction) - Module Membership p < 0.05 based on DEG overalap (view R script)
ModMem_0.05    <- ModMem %>%
dplyr::filter(.[[3]] < 0.05 & .[[4]] > 0.6)
MM_0.5_meanExp <- as.data.frame(colMeans(merge(ModMem_0.05, rlog_WGCNA_D1, by = 'TranscriptID')[,-c(1:3)])) %>%  # mean expression by sampleID for this reduced gene pool (Module membership p < 0.05)
dplyr::mutate(modcolor = loopModCol) %>%
tibble::rownames_to_column("SampleID") %>%
dplyr::rename(meanExp = 2)
# print this loop Rbdin for each module
meanExp_total <- rbind(meanExp_total,MM_0.5_meanExp) #bind to a cumulative list dataframe
print(meanExp_total) # print to monitor progress
# print stats for each module - these will assist stats for the 0.05 threshold
meanExp_statsloop$Day                 <- 1
meanExp_statsloop$modColor            <- loopModCol
meanExp_statsloop$Gene.count          <- nrow(ModMem)
meanExp_statsloop$`Gene.count.MM<0.5` <- nrow(ModMem_0.05)
meanExp_statsloop$`Percent_MM<0.05`   <- (nrow(ModMem_0.05) / nrow(ModMem)) * 100
df            <- data.frame(meanExp_statsloop) # name dataframe for this single row
meanExp_stats <- rbind(meanExp_stats,df) #bind to a cumulative list dataframe
print(meanExp_stats) # print to monitor progress
}
meanExp_total_wide <- reshape2::dcast(meanExp_total, SampleID ~ modcolor, value.var="meanExp") # convert to wide format to merge for OCA analysis with physiological variables
meanExp_Master     <- merge(d2.Seq_SampleKey, meanExp_total_wide) %>% select(-c(Temperature, OA, Salinity, Age.days))
# Run a PCA for Day 1
Master_Day1$Day <- as.factor(Master_Day1$Day) # convert Day into a factor
Day1PCA         <- (merge(Master_Day1, meanExp_Master) %>% dplyr::select(-c(green,yellow)))[-9,]
phys_pca1   <- prcomp(Day1PCA[,c(11:16)],   # modules only   (cumulative 0.6990 )
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
Day1PCA         <- (merge(Master_Day1, meanExp_Master) %>% dplyr::select(-c(green,yellow)))
phys_pca1   <- prcomp(Day1PCA[,c(11:16)],   # modules only   (cumulative 0.6990 )
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
Day1PCA         <- (merge(Master_Day1, meanExp_Master) %>% dplyr::select(-c(green,yellow)))[-9,]
phys_pca1   <- prcomp(Day1PCA[,c(11:16)],   # modules only   (cumulative 0.6990 )
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
# PCA Day 1
phys_pca1   <- prcomp(Day1PCA[,c(3,7,8,11:16)], # all numeric (phys + all modules) - PCA 1 = 0.4133 , PCA 2 0.1786  (cumulative 0.5919)
center = TRUE,
scale. = TRUE)
summary(phys_pca1)
p1pCO2 <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = as.factor(Day1PCA$pCO2),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pcO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Sal <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Salinity,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, salinity") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
p1Temp <- ggbiplot(phys_pca1,
obs.scale = 1,
var.scale = 1,
groups = Day1PCA$Temp,
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.5) +
scale_color_discrete(name = '') +  theme_classic() +  ggtitle("day1, temp") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(ggpubr)
ggarrange(p1Sal, p1pCO2, p1Temp, ncol = 3,nrow = 1)
