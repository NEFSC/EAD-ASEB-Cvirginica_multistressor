xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Survival_to_set,2),"% survival to set"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
# FILTER DATA FOR DAY 1
Survival_means_day1 <- Survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n)))
Survival_means_day1
# FILTER DATA FOR DAY 1
Survival_means_day1 <- Survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n))) +
dplyr::mutate(Survival_to_hatch = (mean_survival) *100 ) %>%
Survival_hatch_means <- as.data.frame(Survival_means_day1 %>%
filter(Day %in% 1) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Survival_to_set = (`1`) *100 ) %>%
dplyr::select(!`1`))
m
# FILTER DATA FOR DAY 1
Survival_means_day1 <- Survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n))) +
dplyr::mutate(Survival_to_hatch = (mean_survival) *100 )
# FILTER DATA FOR DAY 1
Survival_means_day1 <- Survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n))) %>%
dplyr::mutate(Survival_to_hatch = (mean_survival) *100 )
Survival_means_day1
# FILTER DATA FOR DAY 1
Survival_means_day1 <- Survival_dat %>%
dplyr::filter(Day == 1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n))) %>%
dplyr::mutate(Survival_to_hatch = (mean_survival) *100 ) %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
Survival_means_day1
Heatplot <- Survival_means_day1 %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_rect(aes(fill = Survival_to_set),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Survival_to_hatch,2),"% survival to hatch"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
Heatplot <- Survival_means_day1 %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_rect(aes(fill = Survival_to_hatch),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Survival_to_hatch,2),"% survival to hatch"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
Survival_dat
Survival_means_day1
print(Heatplot)
Heatplot <- Survival_means_day1 %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_rect(aes(fill = Survival_to_hatch),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 0.5,
y = 0.8,
label = paste0(round(Survival_to_hatch,2),"% survival to hatch"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Survival/plots/Survival_hatch_facetted.pdf", width=11, height=5)
print(Heatplot)
dev.off()
Survival_all_MeanSE_plot_Day1 <- Survival_means_day1 %>%
dplyr::mutate(AllTreat = as.factor(paste(OA, Salinity, Temp, sep = '_'))) %>%
ggplot(aes(x = as.numeric(Day),
y = mean_survival,
group = AllTreat,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(colour = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
width = 0.5,
position = "dodge2") +
geom_line(aes(x = as.numeric(Day),
y=mean_survival,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
theme_classic() +
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
Survival_all_MeanSE_plot_Day1
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Survival/Survival_all_MeanSE.pdf", width=11, height=6)
print(Survival_all_MeanSE_plot)
dev.off()
print(Survival_all_MeanSE_plot)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# day 1 - length data
raw_length_dat_Age1    <- read.csv("Data/Length_Survival/timepoint_1_Day1.csv", header = T,nrows=50) %>% dplyr::mutate(Age = 1)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# day 1 - length data
raw_length_dat_Age1    <- read.csv("Data/Length/timepoint_1_Day1.csv", header = T,nrows=50) %>% dplyr::mutate(Age = 1)
# day 1 - length data
raw_length_dat_Age4    <- read.csv("Data/Length/timepoint_2_Day4.csv", header = T) %>% dplyr::mutate(Age = 4)
# day 8 - length data
raw_length_dat_Age8_1  <- read.csv("Data/Length/timepoint_3_Day8.csv", header = T) %>% dplyr::mutate(Age = 8)
raw_length_dat_Age8_2  <- read.csv("Data/Length/timepoint_3_Day8_additional_lengths.csv", header = T) %>% dplyr::mutate(Age = 8)
rbind(raw_length_dat_Age8_1,raw_length_dat_Age8_2)
# day 11 - length data
raw_length_dat_Age11   <- read.csv("Data/Length/timepoint_4_Day11.csv", header = T) %>%
dplyr::mutate(Age = 11)
# day 15 - length data
raw_length_dat_Age15   <- read.csv("Data/Length/timepoint_5_Day15.csv", header = T) %>%
dplyr::select(-X) %>%
dplyr::mutate(Age = 15)
# master raw length file
Masterlengthdata    <- rbind(sapply(raw_length_dat_Age1, as.numeric),
sapply(raw_length_dat_Age4, as.numeric),
sapply(raw_length_dat_Age8_1, as.numeric),
sapply(raw_length_dat_Age8_2, as.numeric),
sapply(raw_length_dat_Age11, as.numeric),
sapply(raw_length_dat_Age15, as.numeric))
Masterlengthdata
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# day 1 - length data
raw_length_dat_Age1    <- read.csv("Data/Length/timepoint_1_Day1.csv", header = T,nrows=50) %>% dplyr::mutate(Age = 1)
# day 1 - length data
raw_length_dat_Age4    <- read.csv("Data/Length/timepoint_2_Day4.csv", header = T) %>% dplyr::mutate(Age = 4)
# day 8 - length data
raw_length_dat_Age8_1  <- read.csv("Data/Length/timepoint_3_Day8.csv", header = T) %>% dplyr::mutate(Age = 8)
raw_length_dat_Age8_2  <- read.csv("Data/Length/timepoint_3_Day8_additional_lengths.csv", header = T) %>% dplyr::mutate(Age = 8)
rbind(raw_length_dat_Age8_1,raw_length_dat_Age8_2)
# day 11 - length data
raw_length_dat_Age11   <- read.csv("Data/Length/timepoint_4_Day11.csv", header = T) %>%
dplyr::mutate(Age = 11)
# day 15 - length data
raw_length_dat_Age15   <- read.csv("Data/Length/timepoint_5_Day15.csv", header = T) %>%
dplyr::select(-X) %>%
dplyr::mutate(Age = 15)
# master raw length file
Masterlengthdata    <- rbind(sapply(raw_length_dat_Age1, as.numeric),
sapply(raw_length_dat_Age4, as.numeric),
sapply(raw_length_dat_Age8_1, as.numeric),
sapply(raw_length_dat_Age8_2, as.numeric),
sapply(raw_length_dat_Age11, as.numeric),
sapply(raw_length_dat_Age15, as.numeric))
# Age 1
raw_length_Age1MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 1))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age1_raw_length      <- merge(raw_length_Age1MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 1)
# Age 4
raw_length_Age4MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 4))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age4_raw_length      <- merge(raw_length_Age4MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 4)
# Age 8
raw_length_Age8MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 8))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age8_raw_length      <- merge(raw_length_Age8MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 8)
# Age 11
raw_length_Age11MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 11))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age11_raw_length      <- merge(raw_length_Age11MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 11)
# Age 15
raw_length_Age15MELT <- reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 15))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age15_raw_length      <- merge(raw_length_Age15MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 15)
Master_Lengths <- rbind(Age1_raw_length,
Age4_raw_length,
Age8_raw_length,
Age11_raw_length,
Age15_raw_length)
# master raw length file
Masterlengthdata    <- rbind(sapply(raw_length_dat_Age1, as.numeric),
sapply(raw_length_dat_Age4, as.numeric),
sapply(raw_length_dat_Age8_1, as.numeric),
sapply(raw_length_dat_Age8_2, as.numeric),
sapply(raw_length_dat_Age11, as.numeric),
sapply(raw_length_dat_Age15, as.numeric))
# Age 1
raw_length_Age1MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 1))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age1_raw_length      <- merge(raw_length_Age1MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 1)
# Age 4
raw_length_Age4MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 4))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age4_raw_length      <- merge(raw_length_Age4MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 4)
# Age 8
raw_length_Age8MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 8))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age8_raw_length      <- merge(raw_length_Age8MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 8)
# Age 11
raw_length_Age11MELT <-  reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 11))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age11_raw_length      <- merge(raw_length_Age11MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 11)
# Age 15
raw_length_Age15MELT <- reshape2::melt((as.data.frame(Masterlengthdata) %>% dplyr::filter(Age == 15))) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age15_raw_length      <- merge(raw_length_Age15MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = '')) %>%
dplyr::mutate(Age = 15)
Master_Lengths <- rbind(Age1_raw_length,
Age4_raw_length,
Age8_raw_length,
Age11_raw_length,
Age15_raw_length)
Master_Lengths
Age1_raw_length
Age8_raw_length
Age15_raw_length
Length_means <- Master_Lengths %>%
na.omit() %>%
dplyr::group_by(Age, OA, Salinity, Temp) %>%
dplyr::summarise(mean_length = mean(length_um),
n           = n(),
sd_length   = sd(length_um),
se_length   = sd_length/(sqrt(n)))
GR_means <- as.data.frame(Length_means %>%
filter(Age %in% c(1,15)) %>%
dplyr::select(c(Age, OA, Salinity, Temp, mean_length)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Age, mean_length) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Growth_rate_umday = (`15` - `1`) / 14) %>%
dplyr::select(!c(`1`,`15`))) # note 1 missing value for OA High Temp Low Salinity Low
getNA <- as.data.frame(Length_means %>%
filter(Age %in% c(1,11)) %>%
dplyr::select(c(Age, OA, Salinity, Temp, mean_length)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Age, mean_length) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Growth_rate_umday = (`11` - `1`) / 13) %>%
dplyr::select(!c(`1`,`11`))) # 2.612424 for OA High Temp Low Salinity Low, insert into the other table
GR_means[4,4] = 2.612424
GR_means$Growth_rate_umday <- as.numeric(GR_means$Growth_rate_umday)
Length_means_MASTER <- merge(Length_means, GR_means, by=c('OA', 'Salinity', 'Temp'))
Heatplot <- Length_means_MASTER %>%
dplyr::mutate(OA_Sal =
paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = '')) %>%
ggplot(aes(x = Age,
y = mean_length)) +
geom_rect(aes(fill = Growth_rate_umday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Age,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Growth_rate_umday,2),"% survival to set"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
Heatplot <- Length_means_MASTER %>%
dplyr::mutate(OA_Sal =
paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = '')) %>%
ggplot(aes(x = Age,
y = mean_length)) +
geom_rect(aes(fill = Growth_rate_umday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Age,
y = mean_length)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Growth_rate_umday,2),"um day-1"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length/plots/Length_all_facetted.pdf", width=11, height=5)
print(Heatplot)
dev.off()
Heatplot <- Survival_means_MASTER %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_rect(aes(fill = Survival_to_set),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Survival_to_set,2),"% survival to set"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
