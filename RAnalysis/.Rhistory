high = "forestgreen",
aesthetics = "fill")
print(Heatplot)
Survival_to_set_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Survival_to_set = (`15`) *100 ) %>%
dplyr::select(!`15`))
Survival_means_MASTER <- merge(Survival_means, Survival_to_set_means, by=c('OA', 'Salinity', 'Temp')) %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
Survival_all_MeanSE_plot <- Survival_means %>%
dplyr::mutate(AllTreat = as.factor(paste(OA, Salinity, Temp, sep = '_'))) %>%
ggplot(aes(x = as.numeric(Day),
y = mean_survival,
group = AllTreat,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes(colour = fct_relevel(Salinity, c("Low", "High")),
shape = fct_relevel(OA, c("Low", "High"))),
width = 0.5,
position = "dodge2") +
geom_line(aes(x = as.numeric(Day),
y=mean_survival,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
theme_minimal() +
stat_summary(geom="ribbon", fun.data=mean_cl_normal, width=0.1, conf.int=0.95, fill="lightblue")+
facet_wrap(~(fct_relevel(OA, c("Low", "High"))))
Survival_all_MeanSE_plot # view the plot
Heatplot_day15 <- Survival_means_MASTER %>%
dplyr::filter(Age %in% 15) %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_rect(aes(fill = Survival_to_set),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Survival_to_set,2),"% survival to set"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
Survival_means_MASTER
Heatplot_day15 <- Survival_means_MASTER %>%
dplyr::filter(Day %in% 15) %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_rect(aes(fill = Survival_to_set),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH")))) +
geom_text(size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Survival_to_set,2),"% survival to set"))) +
scale_fill_gradient(low = "orange",
high = "forestgreen",
aesthetics = "fill")
Heatplot_day15
Heatplot_day15 <- Survival_means_MASTER %>%
dplyr::filter(Day %in% 15) %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
Heatplot_day15
Heatplot_day15 <- Survival_means_MASTER %>%
dplyr::filter(Day %in% 15) %>%
dplyr::mutate(Day = as.factor(Day)) %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'black') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5,
position= "dodge2") +
geom_smooth(method = "lm",
se = FALSE,
size = 1,
color = 'white') +
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
facet_grid(vars(Temp),
vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
Heatplot_day15
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Survival/plots/Survival_Day15.pdf", width=11, height=5)
print(Heatplot_day15)
dev.off()
age_15<- Av_length.survival_dat%>%
filter(Day=="15") %>%
arrange(Survival) %>%
mutate(Survival = ifelse(Survival == last(Survival), 0.75, Survival)) # ID #12 was 0.156 -  whereas survival on day 15 was 0.75 - this is an artifact of increased numbers? I changed to 0.75 to reflect no losses between days 15 and 15
Av_length.survival_dat
age_1<- Survival_dat %>%
filter(Day=="1")
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# survival data
Survival_dat <- read.csv("Data/Survival/Survival_master.csv", header = T) %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1),
substr(OA,1,1),
substr(Salinity,1,1), '_', Replicate, sep = ''))
# head(Survival_dat) # view first few lines
age_15<- Survival_dat%>%
filter(Day=="15") %>%
arrange(Survival) %>%
mutate(Survival = ifelse(Survival == last(Survival), 0.75, Survival)) # ID #12 was 0.156 -  whereas survival on day 15 was 0.75 - this is an artifact of increased numbers? I changed to 0.75 to reflect no losses between days 15 and 15
Age15_Survival_lme_mod <- lme(Survival~OA*Salinity*Temp,random=~1|random_fact,data=age_15)
pander(anova(Age15_Survival_lme_mod), style='rmarkdown') # anova table of lm
# |        &nbsp;        | numDF | denDF | F-value | p-value  |
# |:--------------------:|:-----:|:-----:|:-------:|:--------:|
# |   **(Intercept)**    |   1   |  16   |  13.17  | 0.002259 |
# |        **OA**        |   1   |  16   |  2.751  |  0.1166  |
# |     **Salinity**     |   1   |  16   |  6.994  | 0.01766  |
# |       **Temp**       |   1   |  16   | 0.4106  |  0.5307  |
# |   **OA:Salinity**    |   1   |  16   | 0.8238  |  0.3775  |
# |     **OA:Temp**      |   1   |  16   | 0.0958  |  0.7609  |
# |  **Salinity:Temp**   |   1   |  16   | 0.05448 |  0.8184  |
# | **OA:Salinity:Temp** |   1   |  16   | 0.5834  |  0.4561  |
leveneTest(residuals(Age15_Survival_lme_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # 0.4224 pass
boxplot(residuals(Age15_Survival_lme_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # visual of residuals grouped
# run mod (lm model)
Age15_Survival_lm_mod <- lm(Survival~OA*Salinity*Temp,data=age_15)
pander(anova(Age15_Survival_lm_mod), style='rmarkdown') # anova table of lm
# |        &nbsp;        | Df |  Sum Sq  | Mean Sq  | F value | Pr(>F)  |
# |:--------------------:|:--:|:--------:|:--------:|:-------:|:-------:|
# |        **OA**        | 1  | 0.06469  | 0.06469  |  2.751  | 0.1166  |
# |     **Salinity**     | 1  |  0.1644  |  0.1644  |  6.994  | 0.01766 |
# |       **Temp**       | 1  | 0.009654 | 0.009654 | 0.4106  | 0.5307  |
# |   **OA:Salinity**    | 1  | 0.01937  | 0.01937  | 0.8238  | 0.3775  |
# |     **OA:Temp**      | 1  | 0.002252 | 0.002252 | 0.0958  | 0.7609  |
# |  **Salinity:Temp**   | 1  | 0.001281 | 0.001281 | 0.05448 | 0.8184  |
# | **OA:Salinity:Temp** | 1  | 0.01372  | 0.01372  | 0.5834  | 0.4561  |
# |    **Residuals**     | 16 |  0.3762  | 0.02351  |   NA    |   NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod)) # 6.513e-05 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # 0.4224 pass
boxplot(residuals(Age15_Survival_lm_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # visual of residuals grouped
qqnorm(resid(Age15_Survival_lm_mod)) # check for normality of residuals - looks okay
# run mod (lm model)
Age15_Survival_lm_mod <- lm(Survival~OA*Salinity*Temp,data=age_15)
pander(anova(Age15_Survival_lm_mod), style='rmarkdown') # anova table of lm
# |        &nbsp;        | Df |  Sum Sq  | Mean Sq  | F value | Pr(>F)  |
# |:--------------------:|:--:|:--------:|:--------:|:-------:|:-------:|
# |        **OA**        | 1  | 0.06469  | 0.06469  |  2.751  | 0.1166  |
# |     **Salinity**     | 1  |  0.1644  |  0.1644  |  6.994  | 0.01766 |
# |       **Temp**       | 1  | 0.009654 | 0.009654 | 0.4106  | 0.5307  |
# |   **OA:Salinity**    | 1  | 0.01937  | 0.01937  | 0.8238  | 0.3775  |
# |     **OA:Temp**      | 1  | 0.002252 | 0.002252 | 0.0958  | 0.7609  |
# |  **Salinity:Temp**   | 1  | 0.001281 | 0.001281 | 0.05448 | 0.8184  |
# | **OA:Salinity:Temp** | 1  | 0.01372  | 0.01372  | 0.5834  | 0.4561  |
# |    **Residuals**     | 16 |  0.3762  | 0.02351  |   NA    |   NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod)) # 6.513e-05 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # 0.4224 pass
# run mod (lm model)
Age15_Survival_lm_mod <- lm(log(Survival)~OA*Salinity*Temp,data=age_15)
pander(anova(Age15_Survival_lm_mod), style='rmarkdown') # anova table of lm
# |        &nbsp;        | Df |  Sum Sq  | Mean Sq  | F value | Pr(>F)  |
# |:--------------------:|:--:|:--------:|:--------:|:-------:|:-------:|
# |        **OA**        | 1  | 0.06469  | 0.06469  |  2.751  | 0.1166  |
# |     **Salinity**     | 1  |  0.1644  |  0.1644  |  6.994  | 0.01766 |
# |       **Temp**       | 1  | 0.009654 | 0.009654 | 0.4106  | 0.5307  |
# |   **OA:Salinity**    | 1  | 0.01937  | 0.01937  | 0.8238  | 0.3775  |
# |     **OA:Temp**      | 1  | 0.002252 | 0.002252 | 0.0958  | 0.7609  |
# |  **Salinity:Temp**   | 1  | 0.001281 | 0.001281 | 0.05448 | 0.8184  |
# | **OA:Salinity:Temp** | 1  | 0.01372  | 0.01372  | 0.5834  | 0.4561  |
# |    **Residuals**     | 16 |  0.3762  | 0.02351  |   NA    |   NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod)) # 6.513e-05 pass
# run mod (lm model)
Age15_Survival_lm_mod <- lm(sqrt(Survival)~OA*Salinity*Temp,data=age_15)
pander(anova(Age15_Survival_lm_mod), style='rmarkdown') # anova table of lm
# |        &nbsp;        | Df |  Sum Sq  | Mean Sq  | F value | Pr(>F)  |
# |:--------------------:|:--:|:--------:|:--------:|:-------:|:-------:|
# |        **OA**        | 1  | 0.06469  | 0.06469  |  2.751  | 0.1166  |
# |     **Salinity**     | 1  |  0.1644  |  0.1644  |  6.994  | 0.01766 |
# |       **Temp**       | 1  | 0.009654 | 0.009654 | 0.4106  | 0.5307  |
# |   **OA:Salinity**    | 1  | 0.01937  | 0.01937  | 0.8238  | 0.3775  |
# |     **OA:Temp**      | 1  | 0.002252 | 0.002252 | 0.0958  | 0.7609  |
# |  **Salinity:Temp**   | 1  | 0.001281 | 0.001281 | 0.05448 | 0.8184  |
# | **OA:Salinity:Temp** | 1  | 0.01372  | 0.01372  | 0.5834  | 0.4561  |
# |    **Residuals**     | 16 |  0.3762  | 0.02351  |   NA    |   NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod)) # 6.513e-05 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # 0.4224 pass
boxplot(residuals(Age15_Survival_lm_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # visual of residuals grouped
qqnorm(resid(Age15_Survival_lm_mod)) # check for normality of residuals - looks okay
age_15_hightemp<- Survival_dat%>%
filter(Day=="15") %>%
filter(Temp%in%'High') %>%
arrange(Survival) %>%
mutate(Survival = ifelse(Survival == last(Survival), 0.75, Survival)) # ID #12 was 0.156 -  whereas survival on day 15 was 0.75 - this is an artifact of increased numbers? I changed to 0.75 to reflect no losses between days 15 and 15
age_15_hightemp
# run mod (lm model)
Age15_Survival_lm_mod <- lm(sqrt(Survival)~OA*Salinity*Temp,data=age_15_hightemp)
# run mod (lm model)
Age15_Survival_lm_mod <- lm(sqrt(Survival)~OA*Salinity,data=age_15_hightemp)
pander(anova(Age15_Survival_lm_mod), style='rmarkdown') # anova table of lm
# |        &nbsp;        | Df |  Sum Sq  | Mean Sq  | F value | Pr(>F)  |
# |:--------------------:|:--:|:--------:|:--------:|:-------:|:-------:|
# |        **OA**        | 1  | 0.06469  | 0.06469  |  2.751  | 0.1166  |
# |     **Salinity**     | 1  |  0.1644  |  0.1644  |  6.994  | 0.01766 |
# |       **Temp**       | 1  | 0.009654 | 0.009654 | 0.4106  | 0.5307  |
# |   **OA:Salinity**    | 1  | 0.01937  | 0.01937  | 0.8238  | 0.3775  |
# |     **OA:Temp**      | 1  | 0.002252 | 0.002252 | 0.0958  | 0.7609  |
# |  **Salinity:Temp**   | 1  | 0.001281 | 0.001281 | 0.05448 | 0.8184  |
# | **OA:Salinity:Temp** | 1  | 0.01372  | 0.01372  | 0.5834  | 0.4561  |
# |    **Residuals**     | 16 |  0.3762  | 0.02351  |   NA    |   NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod)) # 6.513e-05 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ age_15$Temp*age_15$OA*age_15$Salinity) # 0.4224 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ *age_15$OA*age_15$Salinity) # 0.4224 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ age_15$OA*age_15$Salinity) # 0.4224 pass
# run mod (lm model) - HIGH TEMP MODEL
Age15_Survival_lm_mod_HIGHTEMP <- lm(sqrt(Survival)~OA*Salinity*Temp,data=age_15_hightemp)
# run mod (lm model) - HIGH TEMP MODEL
Age15_Survival_lm_mod_HIGHTEMP <- lm(sqrt(Survival)~OA*Salinity,data=age_15_hightemp)
pander(anova(Age15_Survival_lm_mod_HIGHTEMP), style='rmarkdown') # anova table of lm
# run mod (lm model) - HIGH TEMP MODEL
Age15_Survival_lm_mod_HIGHTEMP <- lm((Survival)~OA*Salinity,data=age_15_hightemp)
pander(anova(Age15_Survival_lm_mod_HIGHTEMP), style='rmarkdown') # anova table of lm
# |     &nbsp;      | Df |  Sum Sq   |  Mean Sq  | F value  |  Pr(>F)  |
# |:---------------:|:--:|:---------:|:---------:|:--------:|:--------:|
# |     **OA**      | 1  |  0.1113   |  0.1113   |  5.094   | 0.05397  |
# |  **Salinity**   | 1  |  0.3728   |  0.3728   |  17.07   | 0.003293 |
# | **OA:Salinity** | 1  | 0.0001596 | 0.0001596 | 0.007309 |  0.934   |
# |  **Residuals**  | 8  |  0.1747   |  0.02184  |    NA    |    NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod)) # 6.513e-05 pass
shapiro.test(residuals(Age15_Survival_lm_mod_HIGHTEMP)) # 6.513e-05 pass
# run mod (lm model) - HIGH TEMP MODEL
Age15_Survival_lm_mod_HIGHTEMP <- lm(sqrt(Survival)~OA*Salinity,data=age_15_hightemp)
pander(anova(Age15_Survival_lm_mod_HIGHTEMP), style='rmarkdown') # anova table of lm
# |     &nbsp;      | Df |  Sum Sq   |  Mean Sq  | F value  |  Pr(>F)  |
# |:---------------:|:--:|:---------:|:---------:|:--------:|:--------:|
# |     **OA**      | 1  |  0.1113   |  0.1113   |  5.094   | 0.05397  |
# |  **Salinity**   | 1  |  0.3728   |  0.3728   |  17.07   | 0.003293 |
# | **OA:Salinity** | 1  | 0.0001596 | 0.0001596 | 0.007309 |  0.934   |
# |  **Residuals**  | 8  |  0.1747   |  0.02184  |    NA    |    NA    |
library(stats)
shapiro.test(residuals(Age15_Survival_lm_mod_HIGHTEMP)) # 6.513e-05 pass
leveneTest(residuals(Age15_Survival_lm_mod) ~ age_15_hightemp$OA*age_15_hightemp$Salinity) # 0.4224 pass
qqnorm(resid(Age15_Survival_lm_mod_HIGHTEMP)) # check for normality of residuals - looks okay
pander(anova(Age15_Survival_lm_mod_HIGHTEMP), style='rmarkdown') # anova table of lm
Age15_Survival_lme_mod <- lme(Survival~OA*Salinity*Temp,random=~1|random_fact,data=age_15)
pander(anova(Age15_Survival_lme_mod), style='rmarkdown') # anova table of lm
Age15Length_lme_mod <- lmer(length_um~OA*Salinity*Temp+(1|random_fact),na.action = na.exclude,data=Age15_raw_length)
anova(Age15Length_lme_mod)
# post hoc tests --------------------------------------------------------------------------------------------------- #
posthoc<-emmeans(Age15Length_lme_mod, pairwise~Salinity:Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
Age15Length_lme_mod <- lmer(length_um~OA*Salinity*Temp+(1|random_fact),na.action = na.exclude,data=Age15_raw_length)
anova(Age15Length_lme_mod)
---
# title: "WGCNA overlapped genes"
# author: "Samuel Gurr"
# date: "Oct 5, 2022"
---
#  LOAD LIBRARIES
library(dplyr)
library(forcats)
library(ggplot2)
library(reshape2)
library(ggpubr)
library(tidyr)
library(tidyverse)
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
path_out = 'C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/WGCNA/' # personnal computer
# master reference view te master ref R script for details
Master_ref  <- read.csv(file= "Data/TagSeq/Seq_details/Seq_Reference_Master.csv", sep=',', header=TRUE) %>%
dplyr::select(c('Cvirginica_TranscriptID','Annotation_GO_ID', 'Cvirginica_length'))
Cvirginica_annot_reference  <- read.csv(file="Data/TagSeq/Seq_details/seq_id_master.csv", sep=',', header=TRUE) %>%
dplyr::select(c('TranscriptID','Function','GeneID')) %>%
dplyr::mutate(TranscriptID = gsub(" ", "", TranscriptID)) %>% # remove the space at the end of each transcript ID
dplyr::mutate(Protein_name = gsub("\\s\\(LOC.*|\\sLOC111.*", "", perl=TRUE, Function)) %>%
dplyr::select(!Function)
d2_Annot_ModuleMembership      <- read.csv("Output/WGCNA/day2_larvae/d2.WGCNA_ModulMembership.csv")
# for loop to call the threshold or module mdembership
d2ModCols                      <- data.frame(moduleColor = unique(d2_Annot_ModuleMembership$moduleColor)) %>% # unique module colors
dplyr::filter(moduleColor %in% c('pink',
'blue',
'turquoise',
'brown',
'black',
'red')) %>% # sig modules
dplyr::mutate(Day = "Day2")
df_total              <- data.frame() # start dataframe
day2_mod_RR           <- data.frame(matrix(nrow = 1, ncol = 5)) # create dataframe to save cumunalitively during for loop
colnames(day2_mod_RR) <- c('Day', 'moduleColor', 'TranscriptID','geneSymbol','Protein_name') # names for comuns in the for loop
for (i in 1:nrow(d2ModCols)) {
# start with loop by calling the row value common with the 'Master_KEGG_BPTerms' data frind from rbind above
modColor         <- d2ModCols[i,1]
loopmodColor_cor <- paste("MM.", modColor, sep = '') # column name for mod color - PEarsons correlation value
loopmodColor_p   <- paste("p.MM.", modColor, sep = '') # column name for mod color - Students asymptotic p value
Mod_loop_d2            <- d2_Annot_ModuleMembership %>%
dplyr::filter(moduleColor %in% modColor) %>%
dplyr::select(c('TranscriptID','geneSymbol','Protein_name','moduleColor', loopmodColor_cor,loopmodColor_p))
Mod_Loop_d2_RRcutoff   <- as.data.frame(Mod_loop_d2 %>%
dplyr::filter(!(.[[5]] <  0.6 & .[[6]] > 0.05)) %>%
dplyr::mutate(Day = "Day2")) %>%
dplyr::select(!c(5,6))
# write csv file for the data reduced mod mem
loopdf       <- data.frame(Mod_Loop_d2_RRcutoff) # name dataframe for this single row
day2_mod_RR  <- rbind(day2_mod_RR,loopdf) #bind to a cumulative list dataframe
print(day2_mod_RR) # print to monitor progress
}
d22_Annot_ModuleMembership     <- read.csv("Output/WGCNA/day18_spat/d18.WGCNA_ModulMembership.csv")
d22ModCols                     <- data.frame(moduleColor = unique(d22_Annot_ModuleMembership$moduleColor)) %>% # unique module colors
dplyr:: filter(moduleColor %in% c('tan',
'red',
'turquoise',
'salmon',
'blue',
'green',
'greenyellow')) %>% # sig modules
dplyr::mutate(Day = "Day22")
df_total              <- data.frame() # start dataframe
day22_mod_RR          <- data.frame(matrix(nrow = 1, ncol = 5)) # create dataframe to save cumunalitively during for loop
colnames(day22_mod_RR) <- c('Day', 'moduleColor', 'TranscriptID','geneSymbol','Protein_name') # names for comuns in the for loop
for (i in 1:nrow(d22ModCols)) {
# start with loop by calling the row value common with the 'Master_KEGG_BPTerms' data frind from rbind above
modColor         <- d22ModCols[i,1]
loopmodColor_cor <- paste("MM.", modColor, sep = '') # column name for mod color - PEarsons correlation value
loopmodColor_p   <- paste("p.MM.", modColor, sep = '') # column name for mod color - Students asymptotic p value
Mod_loop_d22            <- d22_Annot_ModuleMembership %>%
dplyr::filter(moduleColor %in% modColor) %>%
dplyr::select(c('TranscriptID','geneSymbol','Protein_name','moduleColor', loopmodColor_cor,loopmodColor_p))
Mod_Loop_d22_RRcutoff   <- as.data.frame(Mod_loop_d22 %>%
dplyr::filter(!(.[[5]] <  0.6 & .[[6]] > 0.05)) %>%
dplyr::mutate(Day = "Day22")) %>%
dplyr::select(!c(5,6))
loopdf       <- data.frame(Mod_Loop_d22_RRcutoff) # name dataframe for this single row
day22_mod_RR  <- rbind(day22_mod_RR,loopdf) #bind to a cumulative list dataframe
print(day22_mod_RR) # print to monitor progress
}
day2_mod_RR      <- read.csv("Output/WGCNA/day2_larvae/d2.WGCNA_ModulMembership_RRcutoff.csv")
day22_mod_RR      <- read.csv("Output/WGCNA/day2_larvae/d18.WGCNA_ModulMembership_RRcutoff.csv")
day22_mod_RR      <- read.csv("Output/WGCNA/day18_spat/d18.WGCNA_ModulMembership_RRcutoff.csv")
day22_mod_RR
# master WGCNA module data for for loops!
WGCNA_MasterModData   <-  merge( (as.data.frame(rbind(day2_mod_RR,
# d2_Annot_ModuleMembership_hightemp,
day22_mod_RR)) %>%
dplyr::rename(Cvirginica_TranscriptID=TranscriptID)),
Master_ref, by="Cvirginica_TranscriptID")
WGCNA_MasterModData
d2blue <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day2' ~ moduleColor %in% 'blue'))
d22blue  <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'blue'))
WGCNA_MasterModData
day2_mod_RR      <- read.csv("Output/WGCNA/day2_larvae/d2.WGCNA_ModulMembership_RRcutoff.csv") %>% dplyr::mutate(Day = "Day2"))
day2_mod_RR      <- read.csv("Output/WGCNA/day2_larvae/d2.WGCNA_ModulMembership_RRcutoff.csv") %>% dplyr::mutate(Day = "Day2")
day22_mod_RR      <- read.csv("Output/WGCNA/day18_spat/d18.WGCNA_ModulMembership_RRcutoff.csv") %>% dplyr::mutate(Day = "Day22")
# master WGCNA module data for for loops!
WGCNA_MasterModData   <-  merge( (as.data.frame(rbind(day2_mod_RR,
# d2_Annot_ModuleMembership_hightemp,
day22_mod_RR)) %>%
dplyr::rename(Cvirginica_TranscriptID=TranscriptID)),
Master_ref, by="Cvirginica_TranscriptID")
d2blue <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day2' ~ moduleColor %in% 'blue'))
d22blue  <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'blue'))
#merge
modules_HighSalHighExp <- rbind(d2blue, d22blue)
#do genes overlap?
modules_HighSalHighExp_filtered <- as.data.frame(modules_HighSalHighExp %>%
group_by(Cvirginica_TranscriptID,Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1) %>%
select(!n))
modules_HighSalHighExp_filtered
write.csv(modules_HighSalHighExp_filtered,
"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/WGCNA/Shared_Day2blue.Day22blue_HighSal_HighExp.csv")# write
d22red <- WGCNA_MasterModData %>% # low salinity and mid aragonite == high expression
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'turquoise'))
d2turquoise <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day2' ~ moduleColor %in% 'turquoise'))
#merge
modules_LowSalHighExp <- rbind(d22red, d2turquoise)
#do genes overlap?
modules_LowSalHighExp_filtered <- as.data.frame(modules_LowSalHighExp %>%
group_by(Cvirginica_TranscriptID,Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1) %>%
select(!n))
modules_LowSalHighExp_filtered
write.csv(modules_LowSalHighExp_filtered,
"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/WGCNA/Shared_Day2turquoise.Day22turquoise_LowArag_HighExp.csv")# write
d2blue <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day2' ~ moduleColor %in% 'blue'))
d22green  <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'green'))
#merge
modules_LowAragoniteLowExp <- rbind(d2blue, d22green)
#do genes overlap?
modules_LowAragoniteLowExp_filtered <- as.data.frame(modules_LowAragoniteLowExp %>%
group_by(Cvirginica_TranscriptID,Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1) %>%
select(!n))
modules_LowAragoniteLowExp_filtered
d22blue <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'blue'))
d22green  <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'green'))
#merge
modules_LowAragoniteLowExp_Day22 <- rbind(d22blue, d22green)
#do genes overlap?
View(modules_LowAragoniteLowExp_Day22 %>%
group_by(Cvirginica_TranscriptID,Protein_name) %>%
#group_by(Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1))
modules_LowAragoniteLowExp_Day22 %>%
group_by(Cvirginica_TranscriptID,Protein_name)
modules_LowAragoniteLowExp_Day22
View(modules_LowAragoniteLowExp_Day22)
#do genes overlap?
View(modules_LowAragoniteLowExp_Day22 %>%
group_by(Protein_name) %>%
#group_by(Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1))
d22blue
d22blue
d22blue <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'blue')) %>%
dplyr::select(c('Protein_name', 'moduleColor')) %>%
unique()
d22green  <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'green')) %>%
dplyr::select(c('Protein_name', 'moduleColor')) %>%
unique()
d22green
#merge
modules_LowAragoniteLowExp_Day22 <- rbind(d22blue, d22green)
#do genes overlap?
View(modules_LowAragoniteLowExp_Day22 %>%
group_by(Protein_name) %>%
#group_by(Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1))
modules_LowAragoniteLowExp %>%
group_by(Cvirginica_TranscriptID,Protein_name) %>%
dplyr::summarise(n = n())
