reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# plot: dot plot
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.15)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot..pdf"))
plot(model)
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot..pdf"))
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# plot: dot plot
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.15)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot..pdf"))
plot(Day2_DotPlot)
dev.off()
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# plot: dot plot
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.15)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=10, height=5)
plot(Day2_DotPlot)
dev.off()
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# plot: dot plot
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.15)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=20, height=5)
plot(Day2_DotPlot)
dev.off()
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# plot: dot plot
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.15)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=22, height=10)
plot(Day2_DotPlot)
dev.off()
Day2_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
Day18_DotPlot
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day2_GO_DotPlot.pdf"), width=22, height=10)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# Day 18 - modules 'blue', 'turquoise', 'brown'  - these have sig main effects of salinity and temperature!
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=22, height=10)
plot(Day2_DotPlot)
dev.off()
# Day 18 - modules
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day18_GO_DotPlot.pdf"), width=22, height=10)
plot(Day2_DotPlot)
dev.off()
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# Day 18 - modules 'blue', 'turquoise', 'brown'  - these have sig main effects of salinity and temperature!
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=22, height=10)
plot(Day2_DotPlot)
dev.off()
# Day 18 - modules
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day18_GO_DotPlot.pdf"), width=22, height=10)
plot(Day18_DotPlot)
dev.off()
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.15)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
Day18_DotPlot
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.25)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
Day18_DotPlot
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# Day 18 - modules 'blue', 'turquoise', 'brown'  - these have sig main effects of salinity and temperature!
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.1)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=22, height=10)
plot(Day2_DotPlot)
dev.off()
# Day 18 - modules
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,.25)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day18_GO_DotPlot.pdf"), width=22, height=10)
plot(Day18_DotPlot)
dev.off()
unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))
unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol')))
unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol')))
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.25)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
Day2_DotPlot
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# Day 18 - modules 'blue', 'turquoise', 'brown'  - these have sig main effects of salinity and temperature!
Day2_DotPlot <-  ggplot(data =unique(Day2_larvae_master %>%
dplyr::filter(moduleColor %in% c('blue', 'turquoise', 'brown')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.25)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot.pdf"), width=22, height=10)
plot(Day2_DotPlot)
dev.off()
# Day 18 - modules
Day18_DotPlot <-  ggplot(data =unique(Day18_spat_master %>%
dplyr::filter(moduleColor %in% c('blue', 'purple', 'red')) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.5)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day18_GO_DotPlot.pdf"), width=22, height=10)
plot(Day18_DotPlot)
dev.off()
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
df_total
df_total %>%
dplyr::filter(moduleColor %in% WGCNA_ColorList$moduleColor[i]  & Day %in% WGCNA_ColorList$Day[i])
DotPlot <-  ggplot(data =unique(df_total %>%
dplyr::filter(moduleColor %in% WGCNA_ColorList$moduleColor[1]  & Day %in% WGCNA_ColorList$Day[1]) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.25)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
DotPlot
DotPlot <-  ggplot(data =unique(df_total %>%
dplyr::filter(moduleColor %in% WGCNA_ColorList$moduleColor[1]  & Day %in% WGCNA_ColorList$Day[1]) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.5)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
DotPlot
WGCNA_ColorList$moduleColor[1]
WGCNA_ColorList$Day[1]
# Day 18 - modules 'blue', 'turquoise', 'brown'  - these have sig main effects of salinity and temperature!
for (i in 1:nrow(WGCNA_ColorList)) {
DotPlot <-  ggplot(data =unique(df_total %>%
dplyr::filter(moduleColor %in% WGCNA_ColorList$moduleColor[i]  & Day %in% WGCNA_ColorList$Day[i]) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.5)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
if (WGCNA_ColorList$Day[i] == 'Day2') {
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot", WGCNA_ColorList$moduleColor[i], ".pdf", sep = ''), width=10, height=6)
plot(DotPlot)
dev.off()
} else {
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day18_GO_DotPlot", WGCNA_ColorList$moduleColor[i], ".pdf", sep = ''), width=10, height=6)
plot(DotPlot)
dev.off() }
}
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
reorder_within <- function(x, by, within, fun = mean) {
stats::reorder(x, by, FUN = fun) }
# Day 18 - modules 'blue', 'turquoise', 'brown'  - these have sig main effects of salinity and temperature!
for (i in 1:nrow(WGCNA_ColorList)) {
DotPlot <-  ggplot(data =unique(df_total %>%
dplyr::filter(moduleColor %in% WGCNA_ColorList$moduleColor[i]  & Day %in% WGCNA_ColorList$Day[i]) %>%
dplyr::filter(!ontology %in% NA) %>%
dplyr::mutate(moduleColor_Ontology = paste(moduleColor, ontology, sep = '_')) %>%
dplyr::mutate(log_pvalue = -log(pvalue)) %>%
dplyr::arrange(log_pvalue) %>%
dplyr::select(-c('Protein_name', 'Transcript_ID', 'geneSymbol'))),
aes(x = Gene_ratio, y = reorder_within(GO_term, Gene_ratio,moduleColor_Ontology),
color = `log_pvalue`, size = Gene_count)) +
geom_point() +
scale_color_gradient(low = "orange", high = "blue") +
theme_bw() +
ylab("") +
xlab("") +
ggtitle("GO enrichment analysis") +
scale_x_continuous(limits=c(0,0.5)) +
facet_wrap(~moduleColor_Ontology, scales = "free",switch = "y")
if (WGCNA_ColorList$Day[i] == 'Day2') {
pdf(paste0("Output/WGCNA/day2_larvae/GO_analysis/Day2_GO_DotPlot", WGCNA_ColorList$moduleColor[i], ".pdf", sep = ''), width=10, height=6)
plot(DotPlot)
dev.off()
} else {
pdf(paste0("Output/WGCNA/day18_spat/GO_analysis/Day18_GO_DotPlot", WGCNA_ColorList$moduleColor[i], ".pdf", sep = ''), width=10, height=6)
plot(DotPlot)
dev.off() }
}
