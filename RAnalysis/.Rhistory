FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$Salinity
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$Salinity
FINAL_TABLE$pCO2
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$pCO2
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$Temperature
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=4)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
# Sahnnon 12/13/2022 - requested to remove HCO3 and CO2 from the table
# FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=3)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
#
# FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
#                                              "±",
#                                      (signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$CO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# save output table
write.table(carbchem.MASTER_longMEANS,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "latin1")  # write table to
carbchem.MASTER_wideMEANS
# final table
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% dplyr::sort(Ar_out)
# final table
?sort
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% sort(Ar_out)
sort(carbchem.MASTER_wideMEANS$Ar_out)
carbchem.MASTER_wideMEANS
carbchem.MASTER_wideMEANS[order(WAr_out)]
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS[order(,WAr_out)]
carbchem.MASTER_wideMEANS[order(,carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS[order(carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS[order(carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS[order(carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% arrange(Arg_out)
colnames(carbchem.MASTER_wideMEANS)
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% arrange(WAr_out)
carbchem.MASTER_wideMEANS
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
# final table
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% arrange(WAr_out)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
# Sahnnon 12/13/2022 - requested to remove HCO3 and CO2 from the table
# FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=3)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
#
# FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
#                                              "±",
#                                      (signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$CO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# save output table
write.table(carbchem.MASTER_longMEANS,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "latin1")  # write table to
---
# title: "WGCNA overlapped genes"
# author: "Samuel Gurr"
# date: "Oct 5, 2022"
---
#  LOAD LIBRARIES
library(dplyr)
library(forcats)
library(ggplot2)
library(reshape2)
library(ggpubr)
library(tidyr)
library(tidyverse)
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
path_out = 'C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/WGCNA/' # personnal computer
# master reference view te master ref R script for details
Master_ref  <- read.csv(file= "Data/TagSeq/Seq_details/Seq_Reference_Master.csv", sep=',', header=TRUE) %>%
dplyr::select(c('Cvirginica_TranscriptID','Annotation_GO_ID', 'Cvirginica_length'))
Cvirginica_annot_reference  <- read.csv(file="Data/TagSeq/Seq_details/seq_id_master.csv", sep=',', header=TRUE) %>%
dplyr::select(c('TranscriptID','Function','GeneID')) %>%
dplyr::mutate(TranscriptID = gsub(" ", "", TranscriptID)) %>% # remove the space at the end of each transcript ID
dplyr::mutate(Protein_name = gsub("\\s\\(LOC.*|\\sLOC111.*", "", perl=TRUE, Function)) %>%
dplyr::select(!Function)
d2_Annot_ModuleMembership      <- read.csv("Output/WGCNA/day2_larvae/d2.WGCNA_ModulMembership.csv")
# for loop to call the threshold or module mdembership
d2ModCols                      <- data.frame(moduleColor = unique(d2_Annot_ModuleMembership$moduleColor)) %>% # unique module colors
dplyr::filter(moduleColor %in% c('pink',
'blue',
'turquoise',
'brown',
'black',
'red')) %>% # sig modules
dplyr::mutate(Day = "Day2")
df_total              <- data.frame() # start dataframe
day2_mod_RR           <- data.frame(matrix(nrow = 1, ncol = 5)) # create dataframe to save cumunalitively during for loop
colnames(day2_mod_RR) <- c('Day', 'moduleColor', 'TranscriptID','geneSymbol','Protein_name') # names for comuns in the for loop
for (i in 1:nrow(d2ModCols)) {
# start with loop by calling the row value common with the 'Master_KEGG_BPTerms' data frind from rbind above
modColor         <- d2ModCols[i,1]
loopmodColor_cor <- paste("MM.", modColor, sep = '') # column name for mod color - PEarsons correlation value
loopmodColor_p   <- paste("p.MM.", modColor, sep = '') # column name for mod color - Students asymptotic p value
Mod_loop_d2            <- d2_Annot_ModuleMembership %>%
dplyr::filter(moduleColor %in% modColor) %>%
dplyr::select(c('TranscriptID','geneSymbol','Protein_name','moduleColor', loopmodColor_cor,loopmodColor_p))
Mod_Loop_d2_RRcutoff   <- as.data.frame(Mod_loop_d2 %>%
dplyr::filter(.[[6]] < 0.05 & .[[5]] > 0.6) %>%
dplyr::mutate(Day = "Day2")) %>%
dplyr::select(!c(5,6))
# write csv file for the data reduced mod mem
loopdf       <- data.frame(Mod_Loop_d2_RRcutoff) # name dataframe for this single row
day2_mod_RR  <- rbind(day2_mod_RR,loopdf) #bind to a cumulative list dataframe
print(day2_mod_RR) # print to monitor progress
}
day2_ModuleMembership  <- read.csv("Output/WGCNA/day2_larvae/d2.WGCNA_ModulMembership_RRcutoff.csv")
nrow(day2_mod_RR %>% filter(moduleColor %in% 'turquoise'))
d2_Ca2_biomineral <- day2_ModuleMembership %>%
dplyr::filter(moduleColor %in% c('blue',
#'pink',
'turquoise',
#'red',
#'black',
'brown'
)) %>% # sig modules
dplyr::select(c('moduleColor','Protein_name')) %>%
dplyr::mutate(Day = '2') %>%
dplyr::filter(grepl('calmodulin|carbonic anhydrase|calreticulin|perlucin|sodium/calcium|calcium-transporting
|calcium homoeostasis|PIF-like|tyrosinase|gigasin|caltractin', Protein_name, ignore.case = TRUE))
d2_iron_metabol <- day2_ModuleMembership %>%
dplyr::filter(moduleColor %in% c('blue',
#'pink',
'turquoise',
#'red',
#'black',
'brown'
)) %>% # sig modules
dplyr::select(c('moduleColor','Protein_name')) %>%
dplyr::mutate(Day = '2') %>%
dplyr::filter(grepl('ferritin|thioredoxin', Protein_name, ignore.case = TRUE))
d2_oxid_stress <- day2_ModuleMembership %>%
dplyr::filter(moduleColor %in% c('blue',
#'pink',
'turquoise',
#'red',
#'black',
'brown'
)) %>% # sig modules
dplyr::select(c('moduleColor','Protein_name')) %>%
dplyr::mutate(Day = '2') %>%
dplyr::filter(grepl('superoxide|glutathione perox|glutathione S-|peroxidase
|P450|metallothionein|peroxiredoxin|isocitrate dehydrogenase', Protein_name, ignore.case = TRUE))
d2_oxid_phophoyl <- day2_ModuleMembership %>%
dplyr::filter(moduleColor %in% c('blue',
#'pink',
'turquoise',
#'red',
#'black',
'brown'
)) %>% # sig modules
dplyr::select(c('moduleColor','Protein_name')) %>%
dplyr::mutate(Day = '2') %>%
dplyr::filter(grepl('ATP synthase|NADH dehydrogenase
|ubiquinone|cytochrome c
|succinate', Protein_name, ignore.case = TRUE))
d2_oxid_phophoyl
d2_oxid_stress
d2_iron_metabol
d2_Ca2_biomineral
d22_Annot_ModuleMembership     <- read.csv("Output/WGCNA/day18_spat/d18.WGCNA_ModulMembership.csv")
d22ModCols                     <- data.frame(moduleColor = unique(d22_Annot_ModuleMembership$moduleColor)) %>% # unique module colors
dplyr:: filter(moduleColor %in% c('tan',
'red',
'turquoise',
'salmon',
'blue',
'green',
'greenyellow')) %>% # sig modules
dplyr::mutate(Day = "Day22")
df_total              <- data.frame() # start dataframe
day22_mod_RR          <- data.frame(matrix(nrow = 1, ncol = 5)) # create dataframe to save cumunalitively during for loop
colnames(day22_mod_RR) <- c('Day', 'moduleColor', 'TranscriptID','geneSymbol','Protein_name') # names for comuns in the for loop
for (i in 1:nrow(d22ModCols)) {
# start with loop by calling the row value common with the 'Master_KEGG_BPTerms' data frind from rbind above
modColor         <- d22ModCols[i,1]
loopmodColor_cor <- paste("MM.", modColor, sep = '') # column name for mod color - PEarsons correlation value
loopmodColor_p   <- paste("p.MM.", modColor, sep = '') # column name for mod color - Students asymptotic p value
Mod_loop_d22            <- d22_Annot_ModuleMembership %>%
dplyr::filter(moduleColor %in% modColor) %>%
dplyr::select(c('TranscriptID','geneSymbol','Protein_name','moduleColor', loopmodColor_cor,loopmodColor_p))
Mod_Loop_d22_RRcutoff   <- as.data.frame(Mod_loop_d22 %>%
dplyr::filter(!(.[[5]] <  0.6 & .[[6]] > 0.05)) %>%
dplyr::mutate(Day = "Day22")) %>%
dplyr::select(!c(5,6))
loopdf       <- data.frame(Mod_Loop_d22_RRcutoff) # name dataframe for this single row
day22_mod_RR  <- rbind(day22_mod_RR,loopdf) #bind to a cumulative list dataframe
print(day22_mod_RR) # print to monitor progress
}
# master WGCNA module data for for loops!
WGCNA_MasterModData   <-  merge( (as.data.frame(rbind(day2_mod_RR,
# d2_Annot_ModuleMembership_hightemp,
day22_mod_RR)) %>%
dplyr::rename(Cvirginica_TranscriptID=TranscriptID)),
Master_ref, by="Cvirginica_TranscriptID")
d2blue <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day2' ~ moduleColor %in% 'blue'))
d22blue  <- WGCNA_MasterModData %>%
dplyr::filter(case_when(Day == 'Day22' ~ moduleColor %in% 'blue'))
#merge
modules_HighSalHighExp <- rbind(d2blue, d22blue)
#do genes overlap?
modules_HighSalHighExp_filtered <- as.data.frame(modules_HighSalHighExp %>%
group_by(Cvirginica_TranscriptID,Protein_name) %>%
dplyr::summarise(n = n()) %>%
filter(!n %in% 1) %>%
select(!n))
modules_HighSalHighExp_filtered
d22blue
#merge
modules_HighSalHighExp <- rbind(d2blue, d22blue)
modules_HighSalHighExp
