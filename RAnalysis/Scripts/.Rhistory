# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$Salinity
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$Salinity
FINAL_TABLE$pCO2
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$pCO2
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$Temperature
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=4)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$pH
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$TA
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
# Sahnnon 12/13/2022 - requested to remove HCO3 and CO2 from the table
# FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=3)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
#
# FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
#                                              "±",
#                                      (signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$CO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# save output table
write.table(carbchem.MASTER_longMEANS,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "latin1")  # write table to
carbchem.MASTER_wideMEANS
# final table
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% dplyr::sort(Ar_out)
# final table
?sort
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% sort(Ar_out)
sort(carbchem.MASTER_wideMEANS$Ar_out)
carbchem.MASTER_wideMEANS
carbchem.MASTER_wideMEANS[order(WAr_out)]
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS[order(,WAr_out)]
carbchem.MASTER_wideMEANS[order(,carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS[order(carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS[order(carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS[order(carbchem.MASTER_wideMEANS$WAr_out)]
carbchem.MASTER_wideMEANS
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% arrange(Arg_out)
colnames(carbchem.MASTER_wideMEANS)
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% arrange(WAr_out)
carbchem.MASTER_wideMEANS
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
# final table
carbchem.MASTER_wideMEANS <- carbchem.MASTER_wideMEANS %>% arrange(WAr_out)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=4)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=1)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=5)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
# Sahnnon 12/13/2022 - requested to remove HCO3 and CO2 from the table
# FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=3)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
#
# FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
#                                              "±",
#                                      (signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$CO3_out_mmol_gSW,
#                                      ")",
#                                      sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=6)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=4)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# save output table
write.table(carbchem.MASTER_longMEANS,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "latin1")  # write table to
library(ggplot2)
library(dplyr)
library(tidyverse)
library(multcompView)
# library(agricolae)
library(dplyr)
library(lme4)
library(ggplot2)
library(nlme)
library(car)
library(performance)
knitr::opts_chunk$set(echo = TRUE)
# SET WORKING DIRECTORY
# knitr::opts_knit$set(root.dir = "C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB-Airradians_multigen_OA/larvae") # Katie's
knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/EAD-ASEB-Airradians_Larvae_crossgen_OA/RAnalysis") # Sam's
#knitr::opts_knit$set(root.dir = "C:/Users/samuel.gurr/Documents/Github_repositories/EAD-ASEB-Airradians_Larvae_crossgen_OA/RAnalysis") # Sam's work
library(ggplot2)
library(tidyr)
library(dplyr)
library(rcompanion)
library(FSA)
library(car)
library(forcats)
library(kableExtra) # nice Rmd tables
library(emmeans)
library(ggpubr)
library(survival)
library(Rmisc)
library(coxme)
library(survminer)
library(ggsurvfit) # survfit2
library(gtsummary) # tbl_survfit
knitr::opts_chunk$set(echo = TRUE)
# SET WORKING DIRECTORY
# knitr::opts_knit$set(root.dir = "C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB-Airradians_multigen_OA/larvae") # Katie's
#knitr::opts_knit$set(root.dir = "C:/Users/samjg/Documents/Github_repositories/EAD-ASEB-Airradians_Larvae_crossgen_OA/RAnalysis") # Sam's
knitr::opts_knit$set(root.dir = "C:/Users/samuel.gurr/Documents/Github_repositories/EAD-ASEB-Airradians_Larvae_crossgen_OA/RAnalysis") # Sam's work
df <- read.csv("Data/larval_survival.csv", header = T) %>%
dplyr::mutate(Percent_Survival = as.numeric(Percent_Survival)) %>%
# dplyr::select(-treatment) %>%  # redundant column with Exposure_OA
# rename the variables for consistency using 'case_when'
dplyr::mutate(Parental_OA = case_when(Parental_OA ==  "LOW" ~ "Low pCO2",
Parental_OA ==  "MODERATE" ~ "Moderate pCO2",
Parental_OA ==  "HIGH" ~ "High pCO2",
Parental_OA ==  "WILD" ~ "None")) %>%
dplyr::mutate(Exposure_OA = case_when(Exposure_OA ==  "LOW" ~ "Low pCO2",
Exposure_OA ==  "MODERATE" ~ "Moderate pCO2",
Exposure_OA ==  "HIGH" ~ "High pCO2")) %>%
# change the levels for order when plotting - call as factors too!
dplyr::mutate(Parental_OA = as.factor(forcats::fct_relevel(Parental_OA,
c("Low pCO2", "Moderate pCO2", "High pCO2")))) %>%
dplyr::mutate(Exposure_OA = as.factor(forcats::fct_relevel(Exposure_OA,
c("Low pCO2", "Moderate pCO2", "High pCO2")))) %>%
# rename them
dplyr::rename(Parent_pCO2 = Parental_OA) %>%
dplyr::rename(Larvae_pCO2  = Exposure_OA) # done
df$Percent_Survival_trans <- asin(sqrt(df$Percent_Survival))
# head(df)
# str(df)
