se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_MEANS
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_long_MEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideMEANS
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_longMEANS
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
carbchem.MASTER_wideN
colnames(carbchem.MASTER_wideMEANS)
carbchem.MASTER_wideMEANS
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE
carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
"(",
carbchem.MASTER_wideN$t_oC__treatment,
"(",
sep = " ")
FINAL_TABLE$Temperature
(paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3))
(paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± "))
(paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± "))
carbchem.MASTER_wideN$t_oC__treatment
paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
"(",
carbchem.MASTER_wideN$t_oC__treatment,
"(",
sep = " ")
paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
"(",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = " ")
paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
"(",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$Temperature
FINAL_TABLE
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WCa_out,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WCa_out,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WCa_out,
")",
sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
FINAL_TABLE %>%
kbl(caption = "Table 1. Seawater chemistry") %>%
kable_classic(full_width = T, html_font = "Cambria")
# save output table
write.table(carbchem.MASTER_longMEANS,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table_sep.csv",sep=",", row.names=FALSE)  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE)  # write table to
# final table
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=2)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=2)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE)  # write table to
# final table
Encoding(±) <- "UTF-8"
# final table
Encoding(your_text) <- "UTF-8"
# final table
Encoding(FINAL_TABLE) <- "UTF-8"
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "UTF-8")  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "UTF-8")  # write table to
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "latin1")  # write table to
# Purpose: Oyster project 2021 - Respiration rate data
# analysis of respiration rate data
# Written by: Sam J Gurr (last edit 9/14/2021)
# LOAD PACKAGES :::::::::::::::::::::::::::::::::::::::::::::::::::::::
library(dplyr)
library(ggplot2)
library(reshape2)
library(qwraps2)
library(knitr)
library(kableExtra)
library(car)
library(agricolae) # tukey letters
# SET WORKING DIRECTORY :::::::::::::::::::::::::::::::::::::::::::::::
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis") # personal computer
# setwd("C:/Users/samuel.gurr/Documents/Github_repositories/Cvriginica_multistressor/RAnalysis") # Work computer
# LOAD DATA :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# chem <- read.csv(file="Data/Water_chem/Chem_logsheet_raw.csv", header=TRUE) # load the chem data
chem <- read.csv(file="Data/Water_chem/cumulative_raw/Seawater_chem_raw.csv", header=TRUE) # load the chem data
names(chem)<-gsub("\\..","_",names(chem)) # insert underscore sin the column names to ease reading the columns
# View(chem) # view the file
#  CONSOLIDATE TARGET DATA, NAME NEW COLUMNS
names(chem)
chem.aragonite <- chem %>%
tidyr::drop_na(WAr_out) %>% # omit rows with NA for aragonite sat state
dplyr::select(c('Date','Chamber_.','Temp','pCO2','Sal','WAr_out')) %>%
dplyr::mutate(all_treat = paste(Temp,pCO2, Sal, sep = '_')) %>%
dplyr::mutate(OAxSal = paste(pCO2, Sal, sep = '_'))
unique(chem.aragonite$Date) # "4/29/2021" "5/3/2021"  "5/7/2021"  "5/10/2021" "5/14/2021" "5/17/2021"
alltreat.Date.MEANS <- chem.aragonite %>%
dplyr::group_by(Date, all_treat,Temp,pCO2,Sal) %>%
dplyr::summarise(mean_AragoniteSat.date  = mean(WAr_out),
n                 = n(),
sd_AragoniteSat.date   = sd(WAr_out),
se_AragoniteSat.date   = sd_AragoniteSat.date/(sqrt(n)))
# NOTe: full carbonate chemistry was taken non-continuosly, call all rows that contain full carb
carbchem.MASTER         <- chem[!(is.na(chem$WAr_out)),]
colnames(carbchem.MASTER)
# change to long format to properly facet
carbchem.MASTER_long <- carbchem.MASTER %>%
dplyr::select(!c(Chamber_.,
pH_Green_urple,
Total_P_mmol_gSW,
t_oC_spec,
P__dbars,
P_dbars,
Si_Alk_out_mmol_gSW,
Total_Si_mmol_gSW,
B_Alk_out_mmol_gSW,
P_Alk_out_mmol_gSW,
Revelle_out,
TCO2__mmol_gSW__corrected_with_the_CRM_from_preserved_samples,
xCO2_ut_dry_t1atm_ppm)) %>%
melt(id.vars=c('Date', 'Temp', 'pCO2', 'Sal'))
# get the mean. sd. and se for all the data (not by life history!)
carbchem.MASTER_longMEANS <- carbchem.MASTER_long %>% # calc means and standard error
na.omit() %>%
dplyr::group_by(Temp, pCO2, Sal, variable) %>%
dplyr::summarise(mean = mean(value),
sd   = sd(value),
se   = sd/(sqrt(n())) ,
n = n())
carbchem.MASTER_wideMEANS <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="mean")
carbchem.MASTER_wideStErr <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="se")
carbchem.MASTER_wideN     <- dcast(carbchem.MASTER_longMEANS, Temp + pCO2 + Sal ~ variable, value.var="n")
colnames(carbchem.MASTER_wideMEANS)
FINAL_TABLE                <- data.frame(matrix(nrow = nrow(carbchem.MASTER_wideMEANS), ncol = 1))
FINAL_TABLE$sal            <- carbchem.MASTER_wideMEANS$Sal
FINAL_TABLE$OA             <- carbchem.MASTER_wideMEANS$pCO2
FINAL_TABLE$temp           <- carbchem.MASTER_wideMEANS$Temp
FINAL_TABLE$Salinity       <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$Salinity, digits=3)),
(signif(carbchem.MASTER_wideStErr$Salinity, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$Salinity,
")",
sep = "")
FINAL_TABLE$pCO2           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$pCO2_out_matm, digits=3)),
(signif(carbchem.MASTER_wideStErr$pCO2_out_matm, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pCO2_out_matm,
")",
sep = "")
FINAL_TABLE$Temperature    <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$t_oC__treatment, digits=3)),
(signif(carbchem.MASTER_wideStErr$t_oC__treatment, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$t_oC__treatment,
")",
sep = "")
FINAL_TABLE$pH             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$pH_out_chamber, digits=3)),
(signif(carbchem.MASTER_wideStErr$pH_out_chamber, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$pH_out_chamber,
")",
sep = "")
FINAL_TABLE$HCO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$HCO3_out_mmol_gSW, digits=3)),
(signif(carbchem.MASTER_wideStErr$HCO3_out_mmol_gSW, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$HCO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$CO3           <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$CO3_out_mmol_gSW, digits=3)),
"±",
(signif(carbchem.MASTER_wideStErr$CO3_out_mmol_gSW, digits=3)), sep="  ")),
" (",
carbchem.MASTER_wideN$CO3_out_mmol_gSW,
")",
sep = "")
FINAL_TABLE$TA             <- paste( (paste( (signif(carbchem.MASTER_wideMEANS$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)),
(signif(carbchem.MASTER_wideStErr$TA__mmol_gSW__Corrected_with_the_CRM, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$TA__mmol_gSW__Corrected_with_the_CRM,
")",
sep = "")
FINAL_TABLE$Aragonite.Sat  <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WAr_out, digits=3)),
(signif(carbchem.MASTER_wideStErr$WAr_out, digits=3)), sep=" ± ")),
" (",
carbchem.MASTER_wideN$WAr_out,
")",
sep = "")
# FINAL_TABLE$Calcite.Sat    <-  paste( (paste( (signif(carbchem.MASTER_wideMEANS$WCa_out, digits=3)),
#                                      (signif(carbchem.MASTER_wideStErr$WCa_out, digits=2)), sep=" ± ")),
#                                      " (",
#                                      carbchem.MASTER_wideN$WCa_out,
#                                      ")",
#                                      sep = "")
FINAL_TABLE                <- FINAL_TABLE[,-1] # view table
write.table(FINAL_TABLE,"C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/Water_Chem/Chem.Table.csv",sep=",", row.names=FALSE, fileEncoding = "latin1")  # write table to
