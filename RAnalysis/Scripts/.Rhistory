color = Temperature,
label=name)) +
scale_color_manual(values = c("#D55E00", "#56B4E9")) +
scale_shape_manual(values = c(1, 17, 2, 19)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
scale_color_manual(values = c("#D55E00", "#56B4E9")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
png("../Output/DESeq2/Day2_larva/plots/Day2.rlog_PCA_all.png", 1000, 1000, pointsize=20)
ggarrange(d2.PCA_allgroups,d2.PCA_arag.sat, ncol = 1, nrow =2)
dev.off()
ggbiplot(pcaData_d2,
obs.scale = 1,
var.scale = 1,
groups = as.factor(pcaData_d2$OA_Sal),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pCO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggbiplot?
ggbiplot(pcaData_d2,
obs.scale = 1,
var.scale = 1,
groups = as.factor(pcaData_d2$OA_Sal),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pCO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
ggbiplot?
library(ggbiplot)
ggbiplot(pcaData_d2,
obs.scale = 1,
var.scale = 1,
groups = as.factor(pcaData_d2$OA_Sal),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pCO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
library(rlang)
library(dplyr)
library(ggplot2)
library(ggfortify)
library(DESeq2)
library(devtools)
library(ggbiplot)
library(VennDiagram)# venn diagrams
library(eulerr) #venn diagrams -  check out the R shiny app (http://eulerr.co/)
ggbiplot(pcaData_d2,
obs.scale = 1,
var.scale = 1,
groups = as.factor(pcaData_d2$OA_Sal),
ellipse = TRUE,
circle = TRUE,
ellipse.prob = 0.67) +
scale_color_discrete(name = '') +  theme_classic() +   ggtitle("day1, pCO2") +
theme(legend.direction = 'horizontal',
legend.position = 'top')
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse() +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
stat_ellipse()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
geom_point(size =6) +
stat_ellipse()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
geom_point(size =6) +
stat_ellipse(aes(fill = OA_Sal), alpha = 0.25)
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
geom_point(size =6) +
stat_ellipse(aes(fill = Temperature), alpha = 0.25)
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Temperature)), alpha = 0.25)
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Temperature)), alpha = 0.25) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = Temperature,
label=name)) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Temperature)), alpha = 0.7) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)")
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature),
label=name)) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Temperature)), alpha = 0.7) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Temperature)), alpha = 0.7) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17))
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse(aes(fill = factor(Temperature)), alpha = 0.7)
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse(alpha = 0.7)
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse(alpha = 0.7) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
#shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse()
ggplot(pcaData_d2.arag.sat, aes(x = PC1,
y = PC2,
color = Aragonite_saturation,
label=name)) +
scale_color_manual(values = c("#D55E00", "#e69F00", "#56B4E9", "#0072B2")) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Aragonite_saturation))
ggplot(pcaData_d2.arag.sat, aes(x = PC1,
ggplot(pcaData_d2.arag.sat, aes(x = PC1,
y = PC2,
color = Aragonite_saturation,
label=name)) +
scale_color_manual(values = c("#D55E00", "#e69F00", "#56B4E9", "#0072B2")) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Aragonite_saturation)))
d2.PCA_arag.sat <- ggplot(pcaData_d2.arag.sat, aes(x = PC1,
y = PC2,
color = Aragonite_saturation,
label=name)) +
scale_color_manual(values = c("#D55E00", "#e69F00", "#56B4E9", "#0072B2")) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Aragonite_saturation))) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog) aragonite saturation") +
xlab(paste0("PC1: ", percentVar.arag.sat[1], "% variance")) +
ylab(paste0("PC2: ", percentVar.arag.sat[2], "% variance")) +
coord_fixed()
d2.PCA_arag.sat
stat_ellipse()?
d2.PCA_arag.sat <- ggplot(pcaData_d2.arag.sat, aes(x = PC1,
y = PC2,
color = Aragonite_saturation,
label=name)) +
scale_color_manual(values = c("#D55E00", "#e69F00", "#56B4E9", "#0072B2")) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Aragonite_saturation))) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog) aragonite saturation") +
xlab(paste0("PC1: ", percentVar.arag.sat[1], "% variance")) +
ylab(paste0("PC2: ", percentVar.arag.sat[2], "% variance")) +
coord_fixed()
?stat_ellipse()
d2.PCA_arag.sat <- ggplot(pcaData_d2.arag.sat, aes(x = PC1,
y = PC2,
color = Aragonite_saturation,
label=name)) +
scale_color_manual(values = c("#D55E00", "#e69F00", "#56B4E9", "#0072B2")) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Aragonite_saturation)), level = 0.67) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog) aragonite saturation") +
xlab(paste0("PC1: ", percentVar.arag.sat[1], "% variance")) +
ylab(paste0("PC2: ", percentVar.arag.sat[2], "% variance")) +
coord_fixed()
d2.PCA_arag.sat
d2.PCA_arag.sat
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
#stat_ellipse() +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse(aes(factor(OA_Sal)))
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse(aes(fill = factor(OA_Sal)))
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
stat_ellipse(aes(fill = factor(OA_Sal))) +
scale_shape_manual(values = c(1, 19, 2, 17))
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(OA_Sal)))
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(OA_Sal))) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
#stat_ellipse(aes(fill = factor(OA_Sal))) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal)) +
geom_point(size =6) +
scale_color_manual(aes(colour = factor(Temperature)),
values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17))
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal)) +
geom_point(size =6) +
scale_color_manual(aes(fill = factor(Temperature)),
values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
#stat_ellipse(aes(fill = factor(OA_Sal))) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal)) +
geom_point(size =6) +
scale_color_manual(aes(color = factor(Temperature)),
values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17))
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
#stat_ellipse(aes(fill = factor(OA_Sal))) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
pcaData_d2$OA_Temp <- paste(pcaData_d2$OA, pcaData_d2$Temperature, sep = '_')
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
#shape = OA_Sal,
color = factor(OA_Temp))) +
geom_point(size =6) +
#scale_color_manual(values = c("grey20", "grey85")) +
#scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(OA_Temp))) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
#shape = OA_Sal,
color = factor(OA_Temp))) +
geom_point(size =6) +
#scale_color_manual(values = c("grey20", "grey85")) +
#scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(OA_Temp)), level = 0.67) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic()
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
#shape = OA_Sal,
color = factor(Sal_Temp))) +
geom_point(size =6) +
#scale_color_manual(values = c("grey20", "grey85")) +
#scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(Sal_Temp)), level = 0.67) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
pcaData_d2$Sal_Temp <- paste(pcaData_d2$Salinity, pcaData_d2$Temperature, sep = '_')
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
#shape = OA_Sal,
color = factor(Sal_Temp))) +
geom_point(size =6) +
#scale_color_manual(values = c("grey20", "grey85")) +
#scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(Sal_Temp)), level = 0.67) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
d2.PCA_allgroups <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
shape = OA_Sal,
color = factor(Temperature))) +
geom_point(size =6) +
scale_color_manual(values = c("grey20", "grey85")) +
scale_shape_manual(values = c(1, 19, 2, 17)) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_allgroups
d2.PCA_SalTemp <- ggplot(pcaData_d2, aes(x = PC1,
y = PC2,
#shape = OA_Sal,
color = factor(Sal_Temp))) +
geom_point(size =6) +
#scale_color_manual(values = c("grey20", "grey85")) +
#scale_shape_manual(values = c(1, 19, 2, 17)) +
stat_ellipse(aes(fill = factor(Sal_Temp)), level = 0.67) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog)") +
xlab(paste0("PC1: ", percentVar[1], "% variance")) +
ylab(paste0("PC2: ", percentVar[2], "% variance")) +
coord_fixed()
d2.PCA_arag.sat <- ggplot(pcaData_d2.arag.sat, aes(x = PC1,
y = PC2,
color = Aragonite_saturation,
label=name)) +
scale_color_manual(values = c("#D55E00", "#e69F00", "#56B4E9", "#0072B2")) +
geom_text(aes(label=name),hjust=0.2, vjust=1.4, size=5) +
geom_point(size =6) +
stat_ellipse(aes(fill = factor(Aragonite_saturation)), level = 0.67) +
theme_classic() +
theme(text = element_text(size=15)) +
ggtitle("PCA: Day2 (rlog) aragonite saturation") +
xlab(paste0("PC1: ", percentVar.arag.sat[1], "% variance")) +
ylab(paste0("PC2: ", percentVar.arag.sat[2], "% variance")) +
coord_fixed()
png("../Output/DESeq2/Day2_larva/plots/Day2.rlog_PCA_all.png", 1000, 1000, pointsize=20)
ggarrange(d2.PCA_allgroups, d2.PCA_SalTemp, d2.PCA_arag.sat, ncol = 1, nrow =3)
dev.off()
