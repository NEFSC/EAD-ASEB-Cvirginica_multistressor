MF_DOWN_Plot <- Master_goseq_results %>%
dplyr::filter(ontology =='MF' & challenge == 'salinity'& Day == '2') %>%
dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(data = , aes(x = day_dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(over_represented_pvalue)))),by=2))  +
facet_grid(~module_day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('Molecular Function: Primary Effect Downregulated genes (higher by Moderate stress history)') +
# facet_wrap(~ (substr(slim_term, 1,30)))
facet_wrap((substr(term, 1,30)) ~., scales="free_y", ncol= 1, strip.position="right")
MF_DOWN_Plot <- Master_goseq_results %>%
dplyr::filter(ontology =='MF' & challenge == 'salinity'& Day == '2') %>%
dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(aes(x = day_dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(MF_DOWN_Master$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(MF_DOWN_Master$over_represented_pvalue)))),by=2))  +
facet_grid(~module_day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('Molecular Function: Primary Effect Downregulated genes (higher by Moderate stress history)') +
# facet_wrap(~ (substr(slim_term, 1,30)))
facet_wrap((substr(slim_term, 1,30)) ~., scales="free_y", ncol= 1, strip.position="right")
MF_DOWN_Plot <- Master_goseq_results %>%
dplyr::filter(ontology =='MF' & challenge == 'salinity'& Day == '2') %>%
dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(aes(x = day_dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(over_represented_pvalue)))),by=2))  +
facet_grid(~module_day, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('Molecular Function: Primary Effect Downregulated genes (higher by Moderate stress history)') +
# facet_wrap(~ (substr(slim_term, 1,30)))
facet_wrap((substr(slim_term, 1,30)) ~., scales="free_y", ncol= 1, strip.position="right")
Master_goseq_results %>%
dplyr::filter(ontology =='MF' & challenge == 'salinity'& Day == '2') %>%
dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(aes(x = day_dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1))
Master_goseq_results %>%
dplyr::filter(ontology =='MF' & Day == '2') %>%
dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(aes(x = day_dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
#scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))
Master_goseq_results %>%
dplyr::filter(ontology =='MF' & Day == '2') %>%
#dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
#scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))
Master_goseq_results %>%
dplyr::filter(ontology =='MF' & Day == '2') %>%
#dplyr::mutate(day_dir = paste('Day',Day, dir, sep = '_')) %>%
ggplot(aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(Master_goseq_results$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(Master_goseq_results$over_represented_pvalue)))),by=2))
GOres_Day2_MolFunction <- Master_goseq_results %>% dplyr::filter(ontology =='MF' & Day == '2')
GOres_Day2_MolFunction <- Master_goseq_results %>% dplyr::filter(ontology =='MF' & Day == '2')
ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))
MF_DOWN_Plot <- ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Molecular Function') +
# facet_wrap(~ (substr(slim_term, 1,30)))
facet_wrap((substr(slim_term, 1,30)) ~., scales="free_y", ncol= 1, strip.position="right")
MF_DOWN_Plot
MF_Day2_Plot <- ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Molecular Function') +
# facet_wrap(~ (substr(slim_term, 1,30)))
facet_wrap((substr(term, 1,30)) ~., scales="free_y", ncol= 1, strip.position="right")
MF_Day2_Plot
ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Molecular Function')
ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))
ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, scales="free_y", ncol= 1, strip.position="right",labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw()
ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE), strip.position="right")
ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Molecular Function') +
facet_wrap((substr(term, 1,30)) ~., scales="free_y", ncol= 1, strip.position="right")
MF_Day2_Plot <- ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Molecular Function')
MF_Day2_Plot
MF_Day2_Plot
GOres_Day2_BiolProcess <- Master_goseq_results %>% dplyr::filter(ontology =='BP' & Day == '2')
BP_Day2_Plot <- ggplot(data = GOres_Day2_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Biological Process')
BP_Day2_Plot
GOres_Day2_BiolProcess <- Master_goseq_results %>% dplyr::filter(ontology =='BP' & Day == '2') %>%  dplyr::filter(!term %in% 'biological process')
BP_Day2_Plot <- ggplot(data = GOres_Day2_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Biological Process')
BP_Day2_Plot
GOres_Day2_BiolProcess <- Master_goseq_results %>% dplyr::filter(ontology =='BP' & Day == '2') %>%  dplyr::filter(!term %in% 'biological_process')
BP_Day2_Plot <- ggplot(data = GOres_Day2_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Biological Process')
BP_Day2_Plot
GOres_Day18_MolFunction <- Master_goseq_results %>% dplyr::filter(ontology =='MF' & Day == '18')
MF_Day18_Plot <- ggplot(data = GOres_Day18_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue)))),by=18))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.185), "cm"))+
ggtitle('GO analysis Day 18 larvae - Molecular Function')
MF_Day18_Plot
GOres_Day18_BiolProcess <- Master_goseq_results %>% dplyr::filter(ontology =='BP' & Day == '18') %>%  dplyr::filter(!term %in% 'biological_process')
BP_Day18_Plot <- ggplot(data = GOres_Day18_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue)))),by=18))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.185), "cm"))+
ggtitle('GO analysis Day 18 larvae - Biological Process')
BP_Day18_Plot
BP_Day18_Plot <- ggplot(data = GOres_Day18_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue)))),by=18))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.185), "cm"))+
ggtitle('GO analysis Day 18 spat - Biological Process')
BP_Day18_Plot
MF_Day18_Plot
knitr::opts_chunk$set(echo = TRUE)
D7_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
# load libraries - notes show the install command needed to install (pre installed)
library(goseq)
library(dplyr)
library(forcats)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(grDevices)
library(reshape2)
library(Rmisc)
library(ggpubr)
library(tibble)
library(hrbrthemes)
library(gridExtra)
library(tidyr)
library(zoo)
library(ComplexHeatmap)
library(circlize)
library(GSEABase)
library(data.table)
library(stringr)
library(tidyverse)
library(readxl)
D7_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_DOWN_BP  <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Downregulated.csv")
D7_Goslim_UP_MF    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_MolFunction_Upregulated.csv")
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/")
path_out = 'C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/DESeq2/' # personnal computer
D7_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_DOWN_BP  <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Downregulated.csv")
D7_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_DOWN_BP  <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Downregulated.csv")
D7_Goslim_UP_MF    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_MolFunction_Upregulated.csv")
D7_Goslim_DOWN_MF  <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_MolFunction_Downregulated.csv")
D14_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day14/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D14_Goslim_DOWN_BP  <- read.csv("../Output/GO/DESeq2_goseq/Day14/GOterms_and_GOslim_BiolProc_Downregulated.csv")
D14_Goslim_UP_MF    <- read.csv("../Output/GO/DESeq2_goseq/Day14/GOterms_and_GOslim_MolFunction_Upregulated.csv")
D14_Goslim_DOWN_MF  <- read.csv("../Output/GO/DESeq2_goseq/Day14/GOterms_and_GOslim_MolFunction_Downregulated.csv")
D7_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_DOWN_BP  <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Downregulated.csv")
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/")
path_out = 'C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/DESeq2/' # personnal computer
WD()
D7_Goslim_UP_BP    <- read.csv("../../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_UP_BP    <- read.csv("../Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_UP_BP    <- read.csv("/Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
D7_Goslim_UP_BP    <- read.csv("Output/GO/DESeq2_goseq/Day7/primary_effect/GOterms_and_GOslim_BiolProc_Upregulated.csv")
# SET WORKING DIRECTORY AND LOAD DATA
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/")
path_out = 'C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Output/DESeq2/' # personnal computer
# load Day 2 larva GO results (main effect models - within treatment)
Salinity_d2.UP.05       <- read.csv("../Output/DESeq2/Day2_larva/GO_analysis/GO_Salinity_UpregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "up") %>%
dplyr::mutate(Day = '2') %>%
dplyr::mutate(challenge = 'salinity')
Salinity_d2.DOWN.05     <- read.csv("../Output/DESeq2/Day2_larva/GO_analysis/GO_Salinity_DownregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "down") %>%
dplyr::mutate(Day = '2') %>%
dplyr::mutate(challenge = 'salinity')
Temperature_d2.UP.05    <- read.csv("../Output/DESeq2/Day2_larva/GO_analysis/GO_Temperature_UpregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "up") %>%
dplyr::mutate(Day = '2') %>%
dplyr::mutate(challenge = 'temperature')
Temperature_d2.DOWN.05  <- read.csv("../Output/DESeq2/Day2_larva/GO_analysis/GO_Temperature_DownregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "down") %>%
dplyr::mutate(Day = '2') %>%
dplyr::mutate(challenge = 'temperature')
OA_d2.UP.05             <- read.csv("../Output/DESeq2/Day2_larva/GO_analysis/GO_OA_UpregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "up") %>%
dplyr::mutate(Day = '2') %>%
dplyr::mutate(challenge = 'OA')
OA_d2.DOWN.05           <- read.csv("../Output/DESeq2/Day2_larva/GO_analysis/GO_OA_DownregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "down") %>%
dplyr::mutate(Day = '2') %>%
dplyr::mutate(challenge = 'OA')
OA_d18.UP.05         <- read.csv("../Output/DESeq2/Day18_spat/GO_analysis/GO_OA_UpregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "up") %>%
dplyr::mutate(Day = '18') %>%
dplyr::mutate(challenge = 'OA')
OA_d18.DOWN.05       <- read.csv("../Output/DESeq2/Day18_spat/GO_analysis/GO_OA_DownregulatedDEGs.csv")%>%
dplyr::mutate(dir =  "down") %>%
dplyr::mutate(Day = '18') %>%
dplyr::mutate(challenge = 'OA')
Salinity_d18.UP.05   <- read.csv("../Output/DESeq2/Day18_spat/GO_analysis/GO_Salinity_UpregulatedDEGs.csv")  %>%
dplyr::mutate(dir =  "up") %>%
dplyr::mutate(Day = '18') %>%
dplyr::mutate(challenge = 'salinity')
Salinity_d18.DOWN.05 <- read.csv("../Output/DESeq2/Day18_spat/GO_analysis/GO_Salinity_DownregulatedDEGs.csv") %>%
dplyr::mutate(dir =  "down") %>%
dplyr::mutate(Day = '18') %>%
dplyr::mutate(challenge = 'salinity')
Master_goseq_results      <- rbind(Salinity_d2.UP.05, Temperature_d2.UP.05, OA_d2.UP.05,Salinity_d18.UP.05,OA_d18.UP.05,
Salinity_d2.DOWN.05, Temperature_d2.DOWN.05, OA_d2.DOWN.05,Salinity_d18.DOWN.05,OA_d18.DOWN.05) %>%                                   dplyr::filter(!ontology %in% 'CC') # Master GOseq OF ALL PRIMARY EFFECTS
DEG_d2.Temperature <- DE_d2.Temperature %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '2') %>% dplyr::mutate(challenge = 'temperature')
DEGs_d2.Salinity   <- DE_d2.Salinity    %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '2') %>% dplyr::mutate(challenge = 'salinity')
DEG_d2.Temperature <- DE_d2.Temperature %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '2') %>% dplyr::mutate(challenge = 'temperature')
DE_d2.Temperature
# DE files - all genes and filtered raw counts
## main pairwise effect DEGs (salinity, temperature, OA - high vs. low for each)
DE_d2.Temperature <- read.csv(file="C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Data/TagSeq/DESeq2/Day2_larva/Day2.Temperature_DESeq2results.csv", sep=',', header=TRUE)
DE_d2.Salinity    <- read.csv(file="C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Data/TagSeq/DESeq2/Day2_larva/Day2.Salinity_DESeq2results.csv", sep=',', header=TRUE)
DE_d2.OA          <- read.csv(file="C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Data/TagSeq/DESeq2/Day2_larva/Day2.OA_DESeq2results.csv", sep=',', header=TRUE)
DE_d18.Salinity    <- read.csv(file="C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Data/TagSeq/DESeq2/Day18_spat/Day18.salinity_DESeq2results.csv", sep=',', header=TRUE)
DE_d18.OA          <- read.csv(file="C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis/Data/TagSeq/DESeq2/Day18_spat/Day18.OA_DESeq2results.csv", sep=',', header=TRUE)
colnames(DE_d2.Temperature)[2]  == "TranscriptID" # TRUE
colnames(DE_d2.Salinity)[2]     == "TranscriptID" # TRUE
colnames(DE_d2.OA)[2]           == "TranscriptID" # TRUE
colnames(DE_d18.Salinity)[2]     == "TranscriptID" # TRUE
colnames(DE_d18.OA)[2]           == "TranscriptID" # TRUE
#  mapped read counts for each Day (addressed separately in DESeq2)
d2.counts   <- read.csv(file="../Data/TagSeq/Filtered_counts/filtered_counts_5cpm_50perc/day2.filtered_5cpm50perc.csv", sep=',', header=TRUE) %>% dplyr::rename("TranscriptID" = "X")
d18.counts  <- read.csv(file="../Data/TagSeq/Filtered_counts/filtered_counts_5cpm_50perc/day18.counts.filtered_5cpm50perc.csv", sep=',', header=TRUE) %>% dplyr::rename("TranscriptID" = "X")
# annotation master data
# first the crassotrea virginica reference - containing the transcript IDs and functional annotation (nOTE: no KEGG or GO term-level annotation in this file!)
Cvirginica_annot_reference  <- read.csv(file="../Data/TagSeq/Seq_details/seq_id_master.csv", sep=',', header=TRUE) %>%
dplyr::select(c('TranscriptID','Function','GeneID')) %>%
dplyr::mutate(TranscriptID = gsub(" ", "", TranscriptID)) %>% # remove the space at the end of each transcript ID
dplyr::mutate(Protein_name = gsub("\\s\\(LOC.*|\\sLOC111.*", "", perl=TRUE, Function)) %>%
dplyr::select(!Function)
# annotation master data
# first the crassotrea virginica reference - containing the transcript IDs and functional annotation (nOTE: no KEGG or GO term-level annotation in this file!)
Cvirginica_annot_reference  <- read.csv(file="../Data/TagSeq/Seq_details/seq_id_master.csv", sep=',', header=TRUE) %>%
dplyr::select(c('TranscriptID','Function','GeneID')) %>%
dplyr::mutate(TranscriptID = gsub(" ", "", TranscriptID)) %>% # remove the space at the end of each transcript ID
dplyr::mutate(Protein_name = gsub("\\s\\(LOC.*|\\sLOC111.*", "", perl=TRUE, Function)) %>%
dplyr::select(!Function)
nrow(Cvirginica_annot_reference) #66625 including all genes
nrow(Cvirginica_annot_reference %>% dplyr::filter(grepl('uncharacterized', Protein_name))) #27164 EXCLUDING protein names labeled  as 'uncharacterized'
Cvirg_genome3.0  <- read.delim2(file="../Data/TagSeq/Seq_details/GCF_002022765.2_C_virginica-3.0_genomic.txt", skip = 4, header=FALSE) %>%
dplyr::select(c('V3','V4','V5','V9')) %>%
dplyr::rename(Seqtype = V3, start = V4, end = V5, info = V9) %>%
dplyr::filter(Seqtype %in% c('start_codon','stop_codon')) %>%
dplyr::mutate(GeneID = ((str_match(info, "gene_id\\s*(.*?);\\s*transcript"))[,2]) ) %>%
dplyr::mutate(TranscriptID = ((str_match(info, "transcript_id\\s*(.*?);\\s*db_xref"))[,2]) ) %>%
dplyr::select(!info)
DEG_d2.Temperature <- DE_d2.Temperature %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '2') %>% dplyr::mutate(challenge = 'temperature')
DEGs_d2.Salinity   <- DE_d2.Salinity    %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '2') %>% dplyr::mutate(challenge = 'salinity')
DEGs_d2.OA         <- DE_d2.OA          %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down"))  %>% dplyr::mutate(Day = '2') %>% dplyr::mutate(challenge = 'OA')
DEGs_d18.Salinity   <- DE_d18.Salinity    %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '18') %>% dplyr::mutate(challenge = 'salinity')
DEGs_d18.OA         <- DE_d18.OA          %>% dplyr::filter(padj < 0.05) %>%  dplyr::mutate(dir = case_when(log2FoldChange > 0 ~ "up", log2FoldChange <0 ~ "down")) %>% dplyr::mutate(Day = '18')  %>% dplyr::mutate(challenge = 'OA')
Master_DESeq2_results <- rbind(DEG_d2.Temperature[,c('TranscriptID','dir','Day', 'challenge')],
DEGs_d2.Salinity[,c('TranscriptID','dir','Day', 'challenge')],
DEGs_d2.OA[,c('TranscriptID','dir','Day', 'challenge')],
DEGs_d18.Salinity[,c('TranscriptID','dir','Day', 'challenge')],
DEGs_d18.OA[,c('TranscriptID','dir','Day', 'challenge')]) # Master DESeq2
Master_goseq_results
GOres_Day2_MolFunction <- Master_goseq_results %>% dplyr::filter(ontology =='MF' & Day == '2')
MF_Day2_Plot <- ggplot(data = GOres_Day2_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Molecular Function')
MF_Day2_Plot
pdf(paste("../Output/DESeq2/Day2_larva/GO_analysis/Day2_larvae_DEGs_MolFunction.pdf", sep =''), width=20, height=4)
print(MF_Day2_Plot)
dev.off()
GOres_Day2_BiolProcess <- Master_goseq_results %>% dplyr::filter(ontology =='BP' & Day == '2') %>%  dplyr::filter(!term %in% 'biological_process')
BP_Day2_Plot <- ggplot(data = GOres_Day2_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day2_MolFunction$over_represented_pvalue)))),by=2))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.25), "cm"))+
ggtitle('GO analysis Day 2 larvae - Biological Process')
BP_Day2_Plot
pdf(paste("../Output/DESeq2/Day2_larva/GO_analysis/Day2_larvae_DEGs_BiolProcess.pdf", sep =''), width=20, height=4)
print(BP_Day2_Plot)
dev.off()
Master_goseq_results
GOres_Day18_MolFunction <- Master_goseq_results %>% dplyr::filter(ontology =='MF' & Day == '18')
MF_Day18_Plot <- ggplot(data = GOres_Day18_MolFunction,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue)))),by=18))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.185), "cm"))+
ggtitle('GO analysis Day 18 larvae - Molecular Function')
pdf(paste("../Output/DESeq2/Day18_spat/GO_analysis/Day18_spat_DEGs_MolFunction.pdf", sep =''), width=20, height=4)
print(MF_Day18_Plot)
dev.off()
GOres_Day18_BiolProcess <- Master_goseq_results %>% dplyr::filter(ontology =='BP' & Day == '18') %>%  dplyr::filter(!term %in% 'biological_process')
BP_Day18_Plot <- ggplot(data = GOres_Day18_BiolProcess,aes(x = dir, y = forcats::fct_rev(term))) +
geom_tile(aes(fill= -log10(over_represented_pvalue), width = 1)) +
scale_fill_gradient(low = "grey95", high = "black",limits=c(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue))))), breaks=seq(0, (ceiling(max(-log10(GOres_Day18_MolFunction$over_represented_pvalue)))),by=18))  +
facet_grid(~challenge, labeller = label_wrap_gen(width = 10, multi_line = TRUE))+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(),
panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
strip.text.y = element_text(angle=0, size = 8, face = "bold"),
strip.text.x = element_text(size = 8, face = "bold"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=8),
axis.text = element_text(size = 8), legend.position = "right",
plot.margin = unit(c(0,1,0,0.185), "cm"))+
ggtitle('GO analysis Day 18 spat - Biological Process')
BP_Day18_Plot
pdf(paste("../Output/DESeq2/Day18_spat/GO_analysis/Day18_spat_DEGs_BiolProcess.pdf", sep =''), width=20, height=4)
print(BP_Day18_Plot)
dev.off()
