dplyr::filter(p.value < 0.05) %>%
dplyr::mutate(log10_pvalue = -log10(as.numeric(p.value)))
KEGG.Day22 <- rbind(KEGG.Day2,outdat) #bind to a cumulative list dataframe
print(KEGG.Day22) # print to monitor progress
}
KEGG.Day22OM <- na.omit(KEGG.Day22) %>%
dplyr::arrange()
KEGG.Day22OM
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor,
levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = reorder_within(pathway.name, log10_pvalue, modColor)) %>%
ggplot(aes(x=reorder(pathway.name, log10_pvalue), y= log10_pvalue, group = modColor)) +
geom_segment(aes(x=pathway.name, xend=pathway.name,
y=1, yend=log10_pvalue, color=modColor,
#aes(x=pathway.name, xend=pathway.name, y=min(log10_pvalue), yend=max(log10_pvalue)),
#linetype=NA,
size=3)) +   # Draw dashed lines
geom_point( aes(col=modColor, size=as.numeric(Num.genes.exp), fill = "white")) +   # Draw points
scale_color_manual(values = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) +
#ylim(0,8) +
labs(title="Day 22",
x = "Pathway",
y = "-Log(pvalue)",
subtitle="KEGGREST") +
theme_classic() +
theme(
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
legend.position="bottom"
) +
xlab("") +
ylab("") +
ggtitle("Day 2 KEGGREST") +
theme(panel.border = element_blank(), # Set border
panel.grid.major = element_blank(), #Set major gridlines
panel.grid.minor = element_blank(), #Set minor gridlines
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) + #Set the plot background #set title attributes
coord_flip() +
facet_wrap(modColor ~.,
scales="free_y",
ncol= 1,
strip.position="right",
shrink = T)
KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor,
levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = reorder_within(pathway.name, log10_pvalue, modColor)) %>%
ggplot(aes(x=reorder(pathway.name, log10_pvalue), y= log10_pvalue, group = modColor)) +
geom_segment(aes(x=pathway.name, xend=pathway.name,
y=1, yend=log10_pvalue, color=modColor,
#aes(x=pathway.name, xend=pathway.name, y=min(log10_pvalue), yend=max(log10_pvalue)),
#linetype=NA,
size=3))
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor,
levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = reorder_within(pathway.name, log10_pvalue, modColor)) %>%
ggplot(aes(x=reorder(pathway.name, log10_pvalue), y= log10_pvalue, group = modColor)) +
geom_segment(aes(x=pathway.name, xend=pathway.name,
y=1, yend=log10_pvalue, color=modColor,
#aes(x=pathway.name, xend=pathway.name, y=min(log10_pvalue), yend=max(log10_pvalue)),
#linetype=NA,
size=3)) +   # Draw dashed lines
geom_point( aes(col=modColor, size=as.numeric(Num.genes.exp), fill = "white")) +   # Draw points
scale_color_manual(values = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) +
#ylim(0,8) +
labs(title="Day 22",
x = "Pathway",
y = "-Log(pvalue)",
subtitle="KEGGREST") +
theme_classic() +
theme(
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
legend.position="bottom"
) +
xlab("") +
ylab("") +
ggtitle("Day 2 KEGGREST") +
theme(panel.border = element_blank(), # Set border
panel.grid.major = element_blank(), #Set major gridlines
panel.grid.minor = element_blank(), #Set minor gridlines
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) + #Set the plot background #set title attributes
coord_flip() +
facet_wrap(modColor ~.,
scales="free_y",
ncol= 1,
strip.position="right",
shrink = T)
Day22_KEGGSegmentPlot
D22_RichFactor_Plots <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('brown', 'blue', 'turquoise','red', 'pink', 'black')) %>%
dplyr::mutate(modColor = factor(modColor , levels = c('brown', 'blue', 'turquoise', 'red', 'pink', 'black'))) %>%
dplyr::mutate(pathway.name = as.character(reorder_within(pathway.name, Rich_factor, modColor))) %>%
dplyr::mutate(pathway.name = sapply(strsplit(pathway.name, "_"), "[",1)) %>%
ggplot(aes(x=reorder(pathway.name, Rich_factor), y= Rich_factor)) +
geom_point( aes(col=log10_pvalue, size=as.numeric(Num.genes.exp))) +   # Draw points
scale_colour_gradient(low = "#D55E00", high = "#56B4E9", limits = c(0,30)) +
geom_segment(aes(x=pathway.name,
xend=pathway.name,
y=min(Rich_factor),
yend=max(Rich_factor)),
linetype=NA,
size=0) +   # Draw dashed lines
labs(title="KEGG pathway enrichment analysis",
x = "Pathway",
y = "Rich Factor",
subtitle="day 22 WGCNA") +
theme_bw() +
coord_flip() +
facet_wrap(~modColor,scales="free_y")
D22_RichFactor_Plots
# prep loop for cumulative output table
df_total            <- data.frame() # start dataframe
KEGG.Day22           <- data.frame(matrix(nrow = 1, ncol = 10)) # create dataframe to save cumunalitively during for loop
colnames(KEGG.Day22) <- c('Day', 'modColor', 'KEGGID_pathway', 'pathway.name' ,
'Num.genes.all', 'Num.genes.exp', 'Gene.IDs',
'Rich_factor', 'p.value',  'log10_pvalue') # names for comuns in the for loop
# run for loop
for (i in 1:nrow(Day22_WGCNA_sigmodules)) {
modColor   <- Day22_WGCNA_sigmodules[i,1]
ModuleLoop <- as.data.frame(d22_WGCNA.data %>%
dplyr::filter(moduleColor %in% modColor)  %>%
dplyr::select(c('TranscriptID', 'KEGG_ID', 'geneSymbol', 'MM.p', 'MM.cor')) %>%
dplyr::filter(.[[4]] < 0.05 & .[[5]] > 0.6) %>%
dplyr::select(c('TranscriptID', 'KEGG_ID', 'MM.p')) %>%
na.omit() %>%
dplyr::mutate(KEGG_ID = gsub(".*:","",KEGG_ID)) %>%
unnest(KEGG_ID))
geneList <- ModuleLoop[,3]
names(geneList) <- ModuleLoop$KEGG_ID
# Wilcoxon test for each pathway
# length(genes.by.pathway$crg04814)
pVals.by.pathway <- t(sapply(names(genes.by.pathway),
function(pathway) {
pathway.genes         <- genes.by.pathway[[pathway]]
list.genes.in.pathway <- intersect(names(geneList), pathway.genes)
list.genes.not.in.pathway <- setdiff(names(geneList), list.genes.in.pathway)
scores.in.pathway <- geneList[list.genes.in.pathway]
scores.not.in.pathway <- geneList[list.genes.not.in.pathway]
if (length(scores.in.pathway) > 0){
p.value <- wilcox.test(scores.in.pathway,
(length(pathway.genes) - scores.in.pathway),
#scores.not.in.pathway,
alternative = "less")$p.value
} else{
p.value <- NA
}
return(c(p.value = p.value,
Num_total_in_pathway = length(pathway.genes),
Annotated = length(list.genes.in.pathway),
GeneIDs = list(list.genes.in.pathway),
Rich_factor = length(list.genes.in.pathway) / length(pathway.genes) ))
}
))
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway)) %>%
dplyr::mutate(Day = 'Day22',
modColor = modColor) %>%
dplyr::rename(KEGGID_pathway = pathway.code) %>%
dplyr::mutate(pathway.name =  (pathtable %>% dplyr::filter(crg_code == KEGGID_pathway))$pathname,
Num.genes.all = as.data.frame(pVals.by.pathway)$Num_total_in_pathway,
Num.genes.exp = as.data.frame(pVals.by.pathway)$Annotated,
Gene.IDs = as.data.frame(pVals.by.pathway)$GeneIDs,
Rich_factor = as.numeric(pVals.by.pathway[,"Rich_factor"]),
p.value =  as.numeric(pVals.by.pathway[,"p.value"])) %>%
dplyr::filter(p.value < 0.05) %>%
dplyr::mutate(log10_pvalue = -log10(as.numeric(p.value)))
KEGG.Day22 <- rbind(KEGG.Day2,outdat) #bind to a cumulative list dataframe
print(KEGG.Day22) # print to monitor progress
}
KEGG.Day22OM <- na.omit(KEGG.Day22) %>%
dplyr::arrange()
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor,
levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = reorder_within(pathway.name, log10_pvalue, modColor)) %>%
ggplot(aes(x=reorder(pathway.name, log10_pvalue), y= log10_pvalue, group = modColor)) +
geom_segment(aes(x=pathway.name, xend=pathway.name,
y=1, yend=log10_pvalue, color=modColor,
#aes(x=pathway.name, xend=pathway.name, y=min(log10_pvalue), yend=max(log10_pvalue)),
#linetype=NA,
size=3)) +   # Draw dashed lines
geom_point( aes(col=modColor, size=as.numeric(Num.genes.exp), fill = "white")) +   # Draw points
scale_color_manual(values = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) +
#ylim(0,8) +
labs(title="Day 22",
x = "Pathway",
y = "-Log(pvalue)",
subtitle="KEGGREST") +
theme_classic() +
theme(
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
legend.position="bottom"
) +
xlab("") +
ylab("") +
ggtitle("Day 2 KEGGREST") +
theme(panel.border = element_blank(), # Set border
panel.grid.major = element_blank(), #Set major gridlines
panel.grid.minor = element_blank(), #Set minor gridlines
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) + #Set the plot background #set title attributes
coord_flip() +
facet_wrap(modColor ~.,
scales="free_y",
ncol= 1,
strip.position="right",
shrink = T)
Day22_KEGGSegmentPlot
D22_RichFactor_Plots <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor , levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = as.character(reorder_within(pathway.name, Rich_factor, modColor))) %>%
dplyr::mutate(pathway.name = sapply(strsplit(pathway.name, "_"), "[",1)) %>%
ggplot(aes(x=reorder(pathway.name, Rich_factor), y= Rich_factor)) +
geom_point( aes(col=log10_pvalue, size=as.numeric(Num.genes.exp))) +   # Draw points
scale_colour_gradient(low = "#D55E00", high = "#56B4E9", limits = c(0,30)) +
geom_segment(aes(x=pathway.name,
xend=pathway.name,
y=min(Rich_factor),
yend=max(Rich_factor)),
linetype=NA,
size=0) +   # Draw dashed lines
labs(title="KEGG pathway enrichment analysis",
x = "Pathway",
y = "Rich Factor",
subtitle="day 22 WGCNA") +
theme_bw() +
coord_flip() +
facet_wrap(~modColor,scales="free_y")
D22_RichFactor_Plots
KEGG.Day2
KEGG.Day22
# prep loop for cumulative output table
df_total            <- data.frame() # start dataframe
KEGG.Day22           <- data.frame(matrix(nrow = 1, ncol = 10)) # create dataframe to save cumunalitively during for loop
colnames(KEGG.Day22) <- c('Day', 'modColor', 'KEGGID_pathway', 'pathway.name' ,
'Num.genes.all', 'Num.genes.exp', 'Gene.IDs',
'Rich_factor', 'p.value',  'log10_pvalue') # names for comuns in the for loop
# run for loop
for (i in 1:nrow(Day22_WGCNA_sigmodules)) {
modColor   <- Day22_WGCNA_sigmodules[i,1]
ModuleLoop <- as.data.frame(d22_WGCNA.data %>%
dplyr::filter(moduleColor %in% modColor)  %>%
dplyr::select(c('TranscriptID', 'KEGG_ID', 'geneSymbol', 'MM.p', 'MM.cor')) %>%
dplyr::filter(.[[4]] < 0.05 & .[[5]] > 0.6) %>%
dplyr::select(c('TranscriptID', 'KEGG_ID', 'MM.p')) %>%
na.omit() %>%
dplyr::mutate(KEGG_ID = gsub(".*:","",KEGG_ID)) %>%
unnest(KEGG_ID))
geneList <- ModuleLoop[,3]
names(geneList) <- ModuleLoop$KEGG_ID
# Wilcoxon test for each pathway
# length(genes.by.pathway$crg04814)
pVals.by.pathway <- t(sapply(names(genes.by.pathway),
function(pathway) {
pathway.genes         <- genes.by.pathway[[pathway]]
list.genes.in.pathway <- intersect(names(geneList), pathway.genes)
list.genes.not.in.pathway <- setdiff(names(geneList), list.genes.in.pathway)
scores.in.pathway <- geneList[list.genes.in.pathway]
scores.not.in.pathway <- geneList[list.genes.not.in.pathway]
if (length(scores.in.pathway) > 0){
p.value <- wilcox.test(scores.in.pathway,
(length(pathway.genes) - scores.in.pathway),
#scores.not.in.pathway,
alternative = "less")$p.value
} else{
p.value <- NA
}
return(c(p.value = p.value,
Num_total_in_pathway = length(pathway.genes),
Annotated = length(list.genes.in.pathway),
GeneIDs = list(list.genes.in.pathway),
Rich_factor = length(list.genes.in.pathway) / length(pathway.genes) ))
}
))
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway)) %>%
dplyr::mutate(Day = 'Day22',
modColor = modColor) %>%
dplyr::rename(KEGGID_pathway = pathway.code) %>%
dplyr::mutate(pathway.name =  (pathtable %>% dplyr::filter(crg_code == KEGGID_pathway))$pathname,
Num.genes.all = as.data.frame(pVals.by.pathway)$Num_total_in_pathway,
Num.genes.exp = as.data.frame(pVals.by.pathway)$Annotated,
Gene.IDs = as.data.frame(pVals.by.pathway)$GeneIDs,
Rich_factor = as.numeric(pVals.by.pathway[,"Rich_factor"]),
p.value =  as.numeric(pVals.by.pathway[,"p.value"])) %>%
dplyr::filter(p.value < 0.05) %>%
dplyr::mutate(log10_pvalue = -log10(as.numeric(p.value)))
KEGG.Day22 <- rbind(KEGG.Day2,outdat) #bind to a cumulative list dataframe
print(KEGG.Day22) # print to monitor progress
}
KEGG.Day22
# prep loop for cumulative output table
df_total            <- data.frame() # start dataframe
KEGG.Day22           <- data.frame(matrix(nrow = 1, ncol = 10)) # create dataframe to save cumunalitively during for loop
colnames(KEGG.Day22) <- c('Day', 'modColor', 'KEGGID_pathway', 'pathway.name' ,
'Num.genes.all', 'Num.genes.exp', 'Gene.IDs',
'Rich_factor', 'p.value',  'log10_pvalue') # names for comuns in the for loop
# run for loop
for (i in 1:nrow(Day22_WGCNA_sigmodules)) {
modColor   <- Day22_WGCNA_sigmodules[i,1]
ModuleLoop <- as.data.frame(d22_WGCNA.data %>%
dplyr::filter(moduleColor %in% modColor)  %>%
dplyr::select(c('TranscriptID', 'KEGG_ID', 'geneSymbol', 'MM.p', 'MM.cor')) %>%
dplyr::filter(.[[4]] < 0.05 & .[[5]] > 0.6) %>%
dplyr::select(c('TranscriptID', 'KEGG_ID', 'MM.p')) %>%
na.omit() %>%
dplyr::mutate(KEGG_ID = gsub(".*:","",KEGG_ID)) %>%
unnest(KEGG_ID))
geneList <- ModuleLoop[,3]
names(geneList) <- ModuleLoop$KEGG_ID
# Wilcoxon test for each pathway
# length(genes.by.pathway$crg04814)
pVals.by.pathway <- t(sapply(names(genes.by.pathway),
function(pathway) {
pathway.genes         <- genes.by.pathway[[pathway]]
list.genes.in.pathway <- intersect(names(geneList), pathway.genes)
list.genes.not.in.pathway <- setdiff(names(geneList), list.genes.in.pathway)
scores.in.pathway <- geneList[list.genes.in.pathway]
scores.not.in.pathway <- geneList[list.genes.not.in.pathway]
if (length(scores.in.pathway) > 0){
p.value <- wilcox.test(scores.in.pathway,
(length(pathway.genes) - scores.in.pathway),
#scores.not.in.pathway,
alternative = "less")$p.value
} else{
p.value <- NA
}
return(c(p.value = p.value,
Num_total_in_pathway = length(pathway.genes),
Annotated = length(list.genes.in.pathway),
GeneIDs = list(list.genes.in.pathway),
Rich_factor = length(list.genes.in.pathway) / length(pathway.genes) ))
}
))
# Assemble output table
outdat <- data.frame(pathway.code = rownames(pVals.by.pathway)) %>%
dplyr::mutate(Day = 'Day22',
modColor = modColor) %>%
dplyr::rename(KEGGID_pathway = pathway.code) %>%
dplyr::mutate(pathway.name =  (pathtable %>% dplyr::filter(crg_code == KEGGID_pathway))$pathname,
Num.genes.all = as.data.frame(pVals.by.pathway)$Num_total_in_pathway,
Num.genes.exp = as.data.frame(pVals.by.pathway)$Annotated,
Gene.IDs = as.data.frame(pVals.by.pathway)$GeneIDs,
Rich_factor = as.numeric(pVals.by.pathway[,"Rich_factor"]),
p.value =  as.numeric(pVals.by.pathway[,"p.value"])) %>%
dplyr::filter(p.value < 0.05) %>%
dplyr::mutate(log10_pvalue = -log10(as.numeric(p.value)))
KEGG.Day22 <- rbind(KEGG.Day22,outdat) #bind to a cumulative list dataframe
print(KEGG.Day22) # print to monitor progress
}
KEGG.Day22
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor,
levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = reorder_within(pathway.name, log10_pvalue, modColor)) %>%
ggplot(aes(x=reorder(pathway.name, log10_pvalue), y= log10_pvalue, group = modColor)) +
geom_segment(aes(x=pathway.name, xend=pathway.name,
y=1, yend=log10_pvalue, color=modColor,
#aes(x=pathway.name, xend=pathway.name, y=min(log10_pvalue), yend=max(log10_pvalue)),
#linetype=NA,
size=3)) +   # Draw dashed lines
geom_point( aes(col=modColor, size=as.numeric(Num.genes.exp), fill = "white")) +   # Draw points
scale_color_manual(values = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) +
#ylim(0,8) +
labs(title="Day 22",
x = "Pathway",
y = "-Log(pvalue)",
subtitle="KEGGREST") +
theme_classic() +
theme(
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
legend.position="bottom"
) +
xlab("") +
ylab("") +
ggtitle("Day 2 KEGGREST") +
theme(panel.border = element_blank(), # Set border
panel.grid.major = element_blank(), #Set major gridlines
panel.grid.minor = element_blank(), #Set minor gridlines
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) + #Set the plot background #set title attributes
coord_flip() +
facet_wrap(modColor ~.,
scales="free_y",
ncol= 1,
strip.position="right",
shrink = T)
Day22_KEGGSegmentPlot <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor,
levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = reorder_within(pathway.name, log10_pvalue, modColor)) %>%
ggplot(aes(x=reorder(pathway.name, log10_pvalue), y= log10_pvalue, group = modColor)) +
geom_segment(aes(x=pathway.name, xend=pathway.name,
y=1, yend=log10_pvalue, color=modColor,
#aes(x=pathway.name, xend=pathway.name, y=min(log10_pvalue), yend=max(log10_pvalue)),
#linetype=NA,
size=3)) +   # Draw dashed lines
geom_point( aes(col=modColor, size=as.numeric(Num.genes.exp), fill = "white")) +   # Draw points
scale_color_manual(values = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) +
#ylim(0,8) +
labs(title="Day 22",
x = "Pathway",
y = "-Log(pvalue)",
subtitle="KEGGREST") +
theme_classic() +
theme(
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
legend.position="bottom"
) +
xlab("") +
ylab("") +
theme(panel.border = element_blank(), # Set border
panel.grid.major = element_blank(), #Set major gridlines
panel.grid.minor = element_blank(), #Set minor gridlines
axis.line = element_line(colour = "black"), #Set axes color
plot.background=element_blank()) + #Set the plot background #set title attributes
coord_flip() +
facet_wrap(modColor ~.,
scales="free_y",
ncol= 1,
strip.position="right",
shrink = T)
Day22_KEGGSegmentPlot
D22_RichFactor_Plots <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor , levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = as.character(reorder_within(pathway.name, Rich_factor, modColor))) %>%
dplyr::mutate(pathway.name = sapply(strsplit(pathway.name, "_"), "[",1)) %>%
ggplot(aes(x=reorder(pathway.name, Rich_factor), y= Rich_factor)) +
geom_point( aes(col=log10_pvalue, size=as.numeric(Num.genes.exp))) +   # Draw points
scale_colour_gradient(low = "#D55E00", high = "#56B4E9", limits = c(0,30)) +
geom_segment(aes(x=pathway.name,
xend=pathway.name,
y=min(Rich_factor),
yend=max(Rich_factor)),
linetype=NA,
size=0) +   # Draw dashed lines
labs(title="KEGG pathway enrichment analysis",
x = "Pathway",
y = "Rich Factor",
subtitle="day 22 WGCNA") +
theme_bw() +
coord_flip() +
facet_wrap(~modColor,scales="free_y")
D22_RichFactor_Plots
KEGG.Day22OM
KEGG.Day22OM <- na.omit(KEGG.Day22) %>%
dplyr::arrange()
D22_RichFactor_Plots <- KEGG.Day22OM %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor , levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = as.character(reorder_within(pathway.name, Rich_factor, modColor))) %>%
dplyr::mutate(pathway.name = sapply(strsplit(pathway.name, "_"), "[",1)) %>%
ggplot(aes(x=reorder(pathway.name, Rich_factor), y= Rich_factor)) +
geom_point( aes(col=log10_pvalue, size=as.numeric(Num.genes.exp))) +   # Draw points
scale_colour_gradient(low = "#D55E00", high = "#56B4E9", limits = c(0,30)) +
geom_segment(aes(x=pathway.name,
xend=pathway.name,
y=min(Rich_factor),
yend=max(Rich_factor)),
linetype=NA,
size=0) +   # Draw dashed lines
labs(title="KEGG pathway enrichment analysis",
x = "Pathway",
y = "Rich Factor",
subtitle="day 22 WGCNA") +
theme_bw() +
coord_flip() +
facet_wrap(~modColor,scales="free_y")
D22_RichFactor_Plots
KEGG.Day22OM
D22_RichFactor_Plots <- KEGG.Day22OM %>%
dplyr::filter(Num.genes.exp > 1) %>%
dplyr::filter(modColor %in% c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan')) %>%
dplyr::mutate(modColor = factor(modColor , levels = c('blue', 'turquoise', 'red',  'salmon', 'green', 'tan'))) %>%
dplyr::mutate(pathway.name = as.character(reorder_within(pathway.name, Rich_factor, modColor))) %>%
dplyr::mutate(pathway.name = sapply(strsplit(pathway.name, "_"), "[",1)) %>%
ggplot(aes(x=reorder(pathway.name, Rich_factor), y= Rich_factor)) +
geom_point( aes(col=log10_pvalue, size=as.numeric(Num.genes.exp))) +   # Draw points
scale_colour_gradient(low = "#D55E00", high = "#56B4E9", limits = c(0,30)) +
geom_segment(aes(x=pathway.name,
xend=pathway.name,
y=min(Rich_factor),
yend=max(Rich_factor)),
linetype=NA,
size=0) +   # Draw dashed lines
labs(title="KEGG pathway enrichment analysis",
x = "Pathway",
y = "Rich Factor",
subtitle="day 22 WGCNA") +
theme_bw() +
coord_flip() +
facet_wrap(~modColor,scales="free_y")
D22_RichFactor_Plots
