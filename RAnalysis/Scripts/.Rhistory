mod_means <- multcomp::cld(object = mod_means_contr$contrasts,
Letters = letters)
mod_means <- multcomp::CLD(object = mod_means_contr$contrasts,
Letters = letters)
mod_means <- multcomp::cld(object = mod_means_contr$emmeans,
Letters = letters)
mod_means <- cld(object = mod_means_contr$emmeans,
Letters = letters)
mod_means <- CLD.emmGrid(object = mod_means_contr$emmeans,
Letters = letters)
?CLD.emmGrid
mod_means <- CLD.emmGrid(object = mod_means_contr$emmeans,
details = FALSE,
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- cld(object = mod_means_contr$emmeans,
details = FALSE,
sort = TRUE,
alpha = 0.05,
Letters = letters)
?cld
mod_means_contr <- emmeans::emmeans(object = Age1_Survival_lme_mod,
pairwise ~ " OA:Salinity",
adjust = "tukey")
mod_means <- cld(object = mod_means_contr$emmeans,
details = FALSE,
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- multcomp::cld(object = mod_means_contr$emmeans,
details = FALSE,
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means_contr <- emmeans::emmeans(object = Age1_Survival_lme_mod,
specs = " OA:Salinity:Temp")
mod_means_contr <- emmeans::emmeans(object = Age1_Survival_lme_mod,
pairwise ~ " OA:Salinity:Temp",
adjust = "tukey")
mod_means <- multcomp::cld(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
r
mod_means_contr <- emmeans::emmeans(object = Age1_Survival_lme_mod,
pairwise ~ " OA:Salinity:Temp",
adjust = "tukey")
mod_means_contr
mod_means_contr <- as.data.frame(emmeans::emmeans(object = Age1_Survival_lme_mod,
pairwise ~ " OA:Salinity:Temp",
adjust = "tukey"))
mod_means_contr
mod_means_contr$emmeans
mod_means <- multcomp::cld(object = mod_means_contr,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
?cld
?glht
glht(mod_means_contr)
mod_means_contr <- emmeans::emmeans(object = Age1_Survival_lme_mod,
pairwise ~ " OA:Salinity:Temp",
adjust = "tukey")
glht(mod_means_contr)
as.glht(mod_means_contr)
as.glht(mod_means_contr$contrasts)
mod_means <- multcomp::cld(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- multcomp::CLD(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- multcomp::CLD.emmGrid(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
?CLD.emmGrid
require(emmeans)
?emmeans
mod_means <- emmeans::cld(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- emmeans::CLD(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- emmeans::cld.emmGrid(object = mod_means_contr$emmeans,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means_contr
mod_means_contr$emmeans
mod_means <- cld(object = mod_means_contr,
adjust = "Tukey",
sort = TRUE,
alpha = 0.05,
Letters = letters)
mod_means <- cld(object = mod_means_contr,
Letters = letters)
mod_means_contr <- emmeans::emmeans(object = Age1_Survival_lme_mod,
pairwise ~ " OA:Salinity:Temp",
adjust = "tukey")
mod_means <- cld(object = mod_means_contr,
Letters = letters)
mod_means <- cld(object = mod_means_contr,
adjust = 'sidak', Letters = letters)
posthoc<-lsmeans(Age1_Survival_lme_mod, ~OA*Salinity*Temp, adjust="tukey")
posthoc
posthoc<-emmeans(Age1_Survival_lme_mod, pairwise~OA*Salinity*Temp, adjust="tukey")
posthoc
mod_means <- CLD(object = posthoc,alpha = 0.5, Letters = letters)
mod_means <- cld(object = posthoc,alpha = 0.5, Letters = letters)
mod_means <- cld(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
mod_means <- CLD(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
?CLD
library(emmeans)
mod_means <- CLD(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
mod_means <- emmeans::CLD(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
mod_means <- multcomp::cld(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
posthoc$emmeans
posthoc<-lsmeans(Age1_Survival_lme_mod, ~OA*Salinity*Temp, adjust="tukey")
posthoc<-emmeans(Age1_Survival_lme_mod, pairwise~OA*Salinity*Temp, adjust="tukey")
posthoc
tyoeof(posthoc$emmeans)
typeof(posthoc$emmeans)
typeof(posthoc)
posthoc$emmeans
mod_means <- multcomp::cld(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
multcomp::cld(object = posthoc$emmeans,alpha = 0.5, Letters = letters)
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
summary(posthoc)$emmean
as.data.frame(summary(posthoc))['emmean']
as.data.frame(summary(posthoc))
summary(posthoc)
as.data.frame(summary(posthoc))[,'emmean']
summary(posthoc)['emmean']
summary(posthoc)[c('emmean')]
summary(posthoc)
summary(posthoc)[c('emmeans')]
as.data.frame(summary(posthoc))['emmeans']
as.data.frame(summary(posthoc))['emmeans']
as.data.frame(summary(posthoc))
(summary(posthoc$emmeans))
multcomp::cld((summary(posthoc$emmeans)),alpha = 0.5, Letters = letters)
emmeans::cld((summary(posthoc$emmeans)),alpha = 0.5, Letters = letters)
require(emmeans)
detach("package:multcomp", unload = TRUE)
emmeans::cld((summary(posthoc$emmeans)),alpha = 0.5, Letters = letters)
cld((summary(posthoc$emmeans)),alpha = 0.5, Letters = letters)
install.packages('emmeans')
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
install.packages("emmeans")
install.packages('emmeans')
install.packages("emmeans")
install.packages("emmeans")
detach("package:emmeans", unload = TRUE)
install.packages('emmeans')
install.packages("emmeans")
#Set Path
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# raw data
raw_length_dat_Age1    <- read.csv("Data/Length_Survival/timepoint_1_Day1.csv", header = T)
raw_length_dat_Age8    <- (read.csv("Data/Length_Survival/timepoint_2_Day8.csv", header = T) %>% dplyr::select(!X))[-51,] # row 51 has comments in the raw data file
#Set Path
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# raw data
raw_length_dat_Age1    <- read.csv("Data/Length_Survival/timepoint_1_Day1.csv", header = T)
raw_length_dat_Age8    <- (read.csv("Data/Length_Survival/timepoint_2_Day8.csv", header = T) %>% dplyr::select(!X))[-51,] # row 51 has comments in the raw data file
# average data
Av_length.survival_dat <- read.csv("Data/Length_Survival/LengthSurvival_master.csv", header = T) %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = ''))
library(ggplot2)
library(dplyr)
library(tidyverse)
library(multcompView)
library(agricolae)
library(dplyr)
library(lme4)
library(ggplot2)
library(nlme)
library(car)
library(performance)
library(stargazer)
library(emmeans)
#Set Path
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
# raw data
raw_length_dat_Age1    <- read.csv("Data/Length_Survival/timepoint_1_Day1.csv", header = T)
raw_length_dat_Age8    <- (read.csv("Data/Length_Survival/timepoint_2_Day8.csv", header = T) %>% dplyr::select(!X))[-51,] # row 51 has comments in the raw data file
raw_length_dat_Age8    <- sapply(raw_length_dat_Age8, as.numeric)
# average data
Av_length.survival_dat <- read.csv("Data/Length_Survival/LengthSurvival_master.csv", header = T) %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = ''))
head(Av_length.survival_dat)
# extract the experiment data with coresponding sampke Ids from the averaged data master file...
Exp_data <-  Av_length.survival_dat %>% filter(Day %in% 1) %>% dplyr::select(c('Temp','OA','Salinity','Replicate','Id.', 'pH', 'AR')) %>% dplyr::rename(Sample.ID = Id., Aragonite_saturation = AR)
# melt the raw data, cean and format it for merging with Exp_data
# Age 1
raw_length_Age1MELT <- reshape2::melt(raw_length_dat_Age1) %>%
na.omit %>%
dplyr::rename(length_um = value , Sample.ID =variable) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age1_raw_length      <- merge(raw_length_Age1MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = ''))
# Age 1
raw_length_Age8MELT <- reshape2::melt(raw_length_dat_Age8) %>%
na.omit() %>%
dplyr::select(!Var1) %>%
dplyr::rename(length_um = value , Sample.ID =Var2) %>%
dplyr::mutate(Sample.ID = gsub('.*Sample.','', Sample.ID))
Age8_raw_length  <- merge(raw_length_Age8MELT, Exp_data, by = 'Sample.ID')  %>%
dplyr::mutate(random_fact = paste( substr(Temp,1,1), substr(OA,1,1), substr(Salinity,1,1), '_', Replicate, sep = ''))
Age1Length_lme_mod <- lme(length_um~OA*Temp*Salinity,random=~1|random_fact,data=Age1_raw_length)
knitr::kable(anova(Age1Length_lme_mod))
leveneTest(residuals(Age1Length_lme_mod) ~ Age1_raw_length$Temp*Age1_raw_length$OA*Age1_raw_length$Salinity) # 0.2716 PASS
boxplot(residuals(Age1Length_lme_mod) ~ Age1_raw_length$Temp*Age1_raw_length$OA*Age1_raw_length$Salinity) # visual of residuals grouped
qqnorm(resid(Age1Length_lme_mod)) # check for normality of residuals
require(emmeans)
emmeans(Age1Length_lme_mod, list(pairwise ~ OA:Salinity), adjust = "tukey") #posthoc
Age1_ShellLength_Boxplot <- ggplot(data=Age1_raw_length, aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype= Temp)) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_ShellLength_Boxplot)
Age1_ShellLength_Boxplot <- Age1_raw_length %>%
dplyr::filter(Temp %in% 'Low') %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
Age1_ShellLength_Boxplot_hightemp <- Age1_raw_length %>%
dplyr::filter(Temp %in% 'Low') %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_ShellLength_Boxplot_hightemp)
Age1_ShellLength_Boxplot_hightemp <- Age1_raw_length %>%
dplyr::filter(Temp %in% 'Low') %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours (high temp only)", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Length_age_24hrs_Boxplots_hightemp.pdf", width=8, height=6)
print(Age1_ShellLength_Boxplot_hightemp)
dev.off()
print(Age1_ShellLength_Boxplot_hightemp)
Age8Length_lme_mod <- lme(length_um~OA*Salinity*Temp,random=~1|random_fact,data=Age8_raw_length)
knitr::kable(anova(Age8Length_lme_mod))
# high temp only
Age1_ShellLength_Boxplot_hightemp <- Age1_raw_length %>%
dplyr::filter(!Temp %in% 'Low') %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours (high temp only)", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_ShellLength_Boxplot_hightemp)
# high temp only
Age1_ShellLength_Boxplot_hightemp <- Age1_raw_length %>%
dplyr::filter(Temp %in% 'Low') %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours (high temp only)", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_ShellLength_Boxplot_hightemp)
Age1_raw_length_hightemp <- Age1_raw_length %>% dplyr::filter(!Temp %in% 'Low')
# high temp only
Age1_ShellLength_Boxplot_hightemp <- ggplot(data=Age1_raw_length_hightemp, aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours (high temp only)", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_ShellLength_Boxplot_hightemp)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Length_age_24hrs_Boxplots_hightemp.pdf", width=8, height=6)
print(Age1_ShellLength_Boxplot_hightemp)
dev.off()
# run model
Age1Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age1_raw_length_hightemp) # notice temp is removed...
knitr::kable(anova(Age1Length_lme_mod_hightemp))
leveneTest(residuals(Age1Length_lme_mod_hightemp) ~Age1_raw_length_hightemp$OA*Age1_raw_length_hightemp$Salinity) # 0.2716 PASS
boxplot(residuals(Age1Length_lme_mod_hightemp) ~ Age1_raw_length_hightemp$OA*Age1_raw_length_hightemp$Salinity) # visual of residuals grouped
qqnorm(resid(Age1Length_lme_mod_hightemp)) # check for normality of residuals
print(Age1_ShellLength_Boxplot_hightemp)
Age8Length_lme_mod <- lme(length_um~OA*Salinity*Temp,random=~1|random_fact,data=Age8_raw_length)
knitr::kable(anova(Age8Length_lme_mod))
Age8_ShellLength_Boxplot <- ggplot(data=Age8_raw_length, aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype= Temp)) +
geom_boxplot() +
theme_bw() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 8 days", x ="pCO2 level", y = "Shell Length (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age8_ShellLength_Boxplot)
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(!Temp %in% 'Low')
# run model
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
knitr::kable(anova(Age8Length_lme_mod_hightemp))
leveneTest(residuals(Age8Length_lme_mod_hightemp) ~Age8_raw_length_hightemp$OA*Age8_raw_length_hightemp$Salinity) # 0.4058 PASS
boxplot(residuals(Age8Length_lme_mod_hightemp) ~ Age8_raw_length_hightemp$OA*Age8_raw_length_hightemp$Salinity) # visual of residuals grouped
qqnorm(resid(Age8Length_lme_mod_hightemp)) # check for normality of residuals
# high temp only
Age8_ShellLength_Boxplot_hightemp <- ggplot(data=Age8_raw_length_hightemp, aes(x=fct_relevel(OA, c("Low", "High")),
y=length_um,
colour=fct_relevel(Salinity, c("Low", "High")))) +
geom_boxplot() +
theme_classic() +
stat_summary(fun.y="mean",position = position_dodge2(width = 0.75)) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours (high temp only)", x ="pCO2 level", y = "Larvae size (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age8_ShellLength_Boxplot_hightemp)
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Length_age_8days_Boxplots_hightemp.pdf", width=8, height=6)
print(Age8_ShellLength_Boxplot_hightemp)
dev.off()
age_1<- Av_length.survival_dat%>%
filter(Day=="1")
##Here Low Salinity treatments are in Blue
Age1_ShellLength_Boxplot <- ggplot(data=age_1, aes(x=AR, y=Average.Length, fill=Treatment)) +
geom_boxplot()+scale_fill_manual(values=c("darkorange3", "darkorange3","royalblue3", "royalblue3","orange2", "orange2","skyblue2", "skyblue2"))+
geom_jitter( width = 0.02) +
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age =24 hours", x ="Aragonite Saturation State", y = "Shell Length (Î¼m)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_ShellLength_Boxplot)
```{r, echo=FALSE}
age_1<- Av_length.survival_dat %>%
filter(Day=="1")
Age1_Survival_lme_mod <- lme(Survival~OA*Salinity*Temp,random=~1|random_fact,data=age_1)
knitr::kable(anova(Age1_Survival_lme_mod))
leveneTest(residuals(Age1_Survival_lme_mod) ~ age_1$Temp*age_1$OA*age_1$Salinity) # 0.8279- did not pass
boxplot(residuals(Age1_Survival_lme_mod) ~ age_1$Temp*age_1$OA*age_1$Salinity) # visual of residuals grouped
qqnorm(resid(Age1_Survival_lme_mod)) # check for normality of residuals - looks okay
posthoc<-lsmeans(Age1_Survival_lme_mod, ~OA*Salinity*Temp, adjust="tukey")
posthoc<-emmeans(Age1_Survival_lme_mod, pairwise~OA*Salinity*Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
Age1_Survival_Boxplot_2 <- age_1 %>%
dplyr::group_by(OA,Salinity, Temp) %>%
dplyr::summarise(mean_surv = mean(Survival),
n         = n(),
sd_surv   = sd(Survival),
se_surv   = sd_surv/(sqrt(n))) %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=mean_surv,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes (fill = fct_relevel(Salinity, c("Low", "High")), shape = Temp), position = "dodge2") +
geom_errorbar(aes(ymin = mean_surv - se_surv,
ymax = mean_surv + se_surv,
fill = fct_relevel(Salinity, c("Low", "High"))),
width = 0.5, position= "dodge2") +
theme_classic() +
ylim(0.2,0.6) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 24 hours", x ="pCO2 level", y = "Survival")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_Survival_Boxplot_2)
##Here Low Salinity treatments are in Blue
Age1_Survival_Boxplot <- ggplot(data=age_1, aes(x=AR, y=Survival, fill=Treatment)) +
geom_boxplot()+scale_fill_manual(values=c("darkorange3", "darkorange3","royalblue3", "royalblue3","orange2", "orange2","skyblue2", "skyblue2"))+
geom_jitter( width = 0.02) +
theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age =24 hours", x ="Aragonite Saturation State", y = "Survival (%)")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age1_Survival_Boxplot)
age_8<- Av_length.survival_dat%>%
filter(Day=="8")
Age8_Survival_lme_mod <- lme(Survival~OA*Salinity*Temp,random=~1|random_fact,data=age_8)
knitr::kable(anova(Age8_Survival_lme_mod))
leveneTest(residuals(Age8_Survival_lme_mod) ~ age_8$Temp*age_8$OA*age_8$Salinity) # 0.5706 pass
boxplot(residuals(Age8_Survival_lme_mod) ~ age_8$Temp*age_8$OA*age_8$Salinity) # visual of residuals grouped
qqnorm(resid(Age8_Survival_lme_mod)) # check for normality of residuals - looks okay
posthoc<-lsmeans(Age8_Survival_lme_mod, ~OA*Salinity*Temp, adjust="tukey")
posthoc<-emmeans(Age8_Survival_lme_mod, pairwise~OA*Salinity*Temp, adjust="tukey")
multcomp::cld(posthoc$emmeans,alpha = 0.5, Letters = letters)
# plot the data  ----------------------------------------------------------------------------------------------------- #
Age8_Survival_Boxplot_2 <- age_8 %>%
dplyr::group_by(OA,Salinity, Temp) %>%
dplyr::summarise(mean_surv = mean(Survival),
n         = n(),
sd_surv   = sd(Survival),
se_surv   = sd_surv/(sqrt(n))) %>%
ggplot(aes(x=fct_relevel(OA, c("Low", "High")),
y=mean_surv,
colour=fct_relevel(Salinity, c("Low", "High")),
linetype = Temp)) +
geom_point(aes (fill = fct_relevel(Salinity, c("Low", "High")), shape = Temp), position = "dodge2") +
geom_errorbar(aes(ymin = mean_surv - se_surv, ymax = mean_surv + se_surv), width = 0.5, position= "dodge2") +
theme_classic() +
#ylim(0,0.6) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
labs(title="Age = 8 days", x ="pCO2 level", y = "Survival")+
theme(axis.title.y = element_text(size = rel(1.3), angle =90), axis.title.x = element_text(size = rel(1.3), angle = 0))+
theme(axis.text=element_text(size=12))
print(Age8_Survival_Boxplot_2)
Age8_Survival_lme_mod <- lme(Survival~OA*Salinity*Temp,random=~1|random_fact,data=age_8)
knitr::kable(anova(Age8_Survival_lme_mod))
# run model
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
emmeans(Age8Length_lme_mod, list(pairwise ~ OA:Salinity:Temp), adjust = "tukey") #posthoc
Age8Length_lme_mod <- lme(length_um~OA*Salinity*Temp,random=~1|random_fact,data=Age8_raw_length)
knitr::kable(anova(Age8Length_lme_mod))
print(Age8_ShellLength_Boxplot)
knitr::kable(anova(Age8Length_lme_mod))
emmeans(Age8Length_lme_mod, list(pairwise ~ OA:Temp), adjust = "tukey") #posthoc
Age8Length_lme_mod <- lme(length_um~OA*Salinity*Temp,random=~1|random_fact,data=Age8_raw_length)
knitr::kable(anova(Age8Length_lme_mod))
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(!Temp %in% 'Low')
# run model
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
knitr::kable(anova(Age8Length_lme_mod_hightemp))
print(Age8_ShellLength_Boxplot_hightemp)
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(Temp %in% 'Low')
# run model
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
knitr::kable(anova(Age8Length_lme_mod_hightemp))
!
!
!
!
!
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(!Temp %in% 'Low')
# run model
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
#data
Age8_raw_length_hightemp <- Age8_raw_length %>% dplyr::filter(!Temp %in% 'Low')
# run model
Age8Length_lme_mod_hightemp <- lme(length_um~OA*Salinity,random=~1|random_fact,data=Age8_raw_length_hightemp) # notice temp is removed...
knitr::kable(anova(Age8Length_lme_mod_hightemp))
