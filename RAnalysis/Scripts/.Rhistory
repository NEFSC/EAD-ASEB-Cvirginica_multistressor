dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = abs(((`15` - `4`) *100) / 9) ) %>%
dplyr::select(!c(`4`,`15`))) # note 1 missing value for OA low Temp Low Salinity high
getNA <- as.data.frame(Survival_means %>%
filter(Day %in% c(4,11)) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = abs(((`11` - `4`) *100) / 7) ) %>%
dplyr::select(!c(`4`,`11`))) # 2.612424 for OA High Temp Low Salinity Low, insert into the other table
getNA
Mortality_rate_means[7,4] = 3.117895
Survival_means_MASTER <- merge(Survival_means, Mortality_rate_means, by=c('OA', 'Salinity', 'Temp'))
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
data
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Age,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_length,
ymax = mean_survival + se_length),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 5,
y = 0.5,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <- p + scale_fill_gradient(low = "orange", high = "forestgreen", aesthetics = "fill")
p
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_length,
ymax = mean_survival + se_length),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 5,
y = 0.5,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <- p + scale_fill_gradient(low = "orange", high = "forestgreen", aesthetics = "fill")
p
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 5,
y = 0.5,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <- p + scale_fill_gradient(low = "orange", high = "forestgreen", aesthetics = "fill")
p
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 10,
y = 0.5,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <- p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
p
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 5.5,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <- p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
p
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
p
# plot - length
data <- Length_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Age,
y = mean_length)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Age,
y = mean_length)) +
geom_errorbar(aes(ymin = mean_length - se_length,
ymax = mean_length + se_length),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Growth_rate_umday), xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf, alpha = 0.3)
p <- p + geom_text(data = data, size = 2, aes(x = 5, y = 300, label = paste0(round(Growth_rate_umday,2),"um day-1")))
p <- p + scale_fill_gradient(low = "orange", high = "forestgreen", aesthetics = "fill")
p
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Length_all_facetted.pdf", width=11, height=6)
print(p)
dev.off()
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
setwd("C:/Users/samjg/Documents/Github_repositories/Cvirginica_multistressor/RAnalysis")
pdf("Output/Length_Survival/Survival_all_facetted.pdf", width=11, height=6)
print(p)
dev.off()
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% c(4,11)) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = abs(((`11` - `4`) *100) / 7) ) %>%
dplyr::select(!c(`4`,`11`))) # note 1 missing value for OA low Temp Low Salinity high
Mortality_rate_means
Survival_means_MASTER <- merge(Survival_means, Mortality_rate_means, by=c('OA', 'Salinity', 'Temp'))
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% c(4,11)) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`11`) *100 ) %>%
dplyr::select(!c(`4`,`11`))) # note 1 missing value for OA low Temp Low Salinity high
Survival_means_MASTER <- merge(Survival_means, Mortality_rate_means, by=c('OA', 'Salinity', 'Temp'))
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`15`) *100 ) %>%
dplyr::select(!`11`)) # note 1 missing value for OA low Temp Low Salinity high
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`15`) *100 ) %>%
dplyr::select(!`15`)) # note 1 missing value for OA low Temp Low Salinity high
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`15`) *100 ) %>%
dplyr::select(!`15`)) # note 1 missing value for OA low Temp Low Salinity high
Mortality_rate_means
Mortality_rate_means[7,4]
Mortality_rate_means[7,4]
Mortality_rate_means
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`15`) *100 ) %>%
dplyr::select(!`15`)) # note 1 missing value for OA low Temp Low Salinity high
Mortality_rate_means
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`15`) *100 ) %>%
dplyr::select(!`15`))
Survival_means_MASTER <- merge(Survival_means, Mortality_rate_means, by=c('OA', 'Salinity', 'Temp'))
Mortality_rate_means
Survival_means_MASTER <- merge(Survival_means, Mortality_rate_means, by=c('OA', 'Salinity', 'Temp'))
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
Survival_means
data
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
Mortality_rate_means
Survival_means <- Av_length.survival_dat %>%
dplyr::filter(Day >1) %>%
na.omit() %>%
dplyr::group_by(Day, OA, Salinity, Temp) %>%
dplyr::summarise(mean_survival = mean(Survival),
n           = n(),
sd_survival   = sd(Survival),
se_survival   = sd_survival/(sqrt(n)))
Mortality_rate_means <- as.data.frame(Survival_means %>%
filter(Day %in% 15) %>%
dplyr::select(c(Day, OA, Salinity, Temp, mean_survival)) %>%
dplyr::group_by(OA, Salinity, Temp)  %>%
tidyr::spread(Day, mean_survival) %>%  # new columns titled 1 and 15 for he Age and with values for the
# length data grouped by treatment
dplyr::mutate(Mortality_rate_percday = (`15`) *100 ) %>%
dplyr::select(!`15`))
Survival_means_MASTER <- merge(Survival_means, Mortality_rate_means, by=c('OA', 'Salinity', 'Temp'))
# plot - length
data <- Survival_means_MASTER %>%
dplyr::mutate(OA_Sal = paste(substr(OA,1,1),
substr(Salinity,1,1),
sep = ''))
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p <- p + geom_rect(data = data, aes(fill = Mortality_rate_percday),
xmin = -Inf,
xmax = Inf,
ymin = -Inf,
ymax = Inf,
alpha = 0.3)
p <- p + geom_text(data = data, size = 2,
aes(x = 12,
y = 0.8,
label = paste0(round(Mortality_rate_percday,2),"% day-1")))
p <-p + scale_fill_gradient(low = "forestgreen", high = "orange", aesthetics = "fill")
print(p)
data
p <- data %>%
ggplot(aes(x = Day,
y = mean_survival)) +
geom_point(color = 'grey80') +
geom_line(aes(x = Day,
y = mean_survival)) +
geom_errorbar(aes(ymin = mean_survival - se_survival,
ymax = mean_survival + se_survival),
width = 0.5, position= "dodge2") +
geom_smooth(method = "lm", se = FALSE, size = 0.5, color = 'white') +
theme_bw() +
facet_grid(vars(Temp), vars(fct_relevel(OA_Sal, c("HL", "LL", "HH", "LH"))))
p
data
